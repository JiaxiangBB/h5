function accountBalanceCtrl(e,a,o,t){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data"),e.isApp=getURLParameter("isApp"),"1"==e.isApp?e.isAppFlag=!0:e.isAppFlag=!1,e.onAccountBalanceBackFun=function(){callHandler("onAccountBalanceBackApp",{isApp:"1"},function(e){})},$("#accountBalance-view .accountBalanceImg").attr("src",imgRrc+"h5images/icon_jinegai_yellow"+variable+".png"),$("#paymentMethod-view .paymentMethod .cardImg01").css("background-image","url("+imgRrc+"h5images/icon_bank_zgnyyh"+variable+".png)"),$("#paymentMethod-view .paymentMethod .cardImg02").css("background-image","url("+imgRrc+"h5images/icon_bank_zgnyyh"+variable+".png)"),$("#paymentMethod-view .jinru_back").css("background-image","url("+imgRrc+"h5images/icon_jinru_black"+variable+".png)"),$("#bankPhoneCode-view .bankPhoneCode .rechargeNum").css("background-image","url("+imgRrc+"h5images/jine"+variable+".png)");s={};s.customerNo=e.customerNo,s.sessionId=e.sessionId,$.ajax({url:getRootPath()+"/CustomerAction.custInfoQuery.do?FAPView=JSON",type:"post",data:s,success:function(o){if(0==(o=$.parseJSON(o)).FAPStatus)if(1==o.success){var t=o.data.certNo,s=o.data.customerNameCN,r=o.data.mobileNo;e.customerNameCN=s,e.mobileNo=r,e.certNo=t,e.accountBalance=localStorage.getItem("numBer");var n={customerNameCN:e.customerNameCN,mobileNo:e.mobileNo,certNo:e.certNo,accountBalance:e.accountBalance},i=angular.toJson(n),c={cardNo:"",money:e.accountBalance,bankCardType:""},l=angular.toJson(c);e.rechargeFun=function(){a.go("bankPhoneCode",{jsonAccountObj:i,jsonPayObj:l})}}else e.msg=o.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==o.FAPStatus?loginH5Host():(e.msg=o.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}});var s;(s={}).customerNo=e.customerNo,$.ajax({url:getRootPath()+"/PrepaidCardAction.cardBalQuery.do?FAPView=JSON",type:"post",data:s,success:function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success){e.accountBalance=fmoney(a.data.bankLists.avaAccountBalance,2),e.balance_wrap=fmoney(a.data.bankLists.avaBalance,2),localStorage.setItem("numBer",e.accountBalance);localStorage.getItem("numBer")}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}}),e.transactionDetails=function(){a.go("transactionDetails")},t.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function bankPhoneCodeCtrl(e,a,o,t,s){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data"),e.certNo=localStorage.getItem("certNoData"),$("#accountBalance-view .accountBalanceImg").attr("src",imgRrc+"h5images/icon_jinegai_yellow"+variable+".png"),$("#paymentMethod-view .paymentMethod .cardImg01").css("background-image","url("+imgRrc+"h5images/icon_bank_zgnyyh"+variable+".png)"),$("#paymentMethod-view .paymentMethod .cardImg02").css("background-image","url("+imgRrc+"h5images/icon_bank_zgnyyh"+variable+".png)"),$("#paymentMethod-view .jinru_back").css("background-image","url("+imgRrc+"h5images/icon_jinru_black"+variable+".png)"),$("#bankPhoneCode-view .bankPhoneCode .rechargeNum").css("background-image","url("+imgRrc+"h5images/jine"+variable+".png)");var r=angular.fromJson(t.jsonAccountObj);e.mobileNo=r.mobileNo,e.certType=r.certType,e.customerNameCN=r.customerNameCN,e.certNo=r.certNo,e.accountBalance=r.accountBalance;var n={customerNameCN:e.customerNameCN,mobileNo:e.mobileNo,certNo:e.certNo,accountBalance:e.accountBalance},i=angular.toJson(n),c=angular.fromJson(t.jsonPayObj);e.cardNo=c.cardNo,e.money=c.money,e.bankCardType=c.bankCardType;var l={cardNo:e.cardNo,money:e.money,bankCardType:e.bankCardType},m=angular.toJson(l);e.paymentMethod=function(){var a={};a.customerNo=e.customerNo,$.ajax({url:getRootPath()+"/PrepaidCardAction.cardQuery.do?FAPView=JSON",type:"post",data:a,success:function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success){var t=a.data.bankcard;a.data.cdcard;0==a.data.bankcard.length?($(".payCardlist_null").css("display","block"),$(".payCardlist_card").css("display","none"),e.addBankView=function(){if(""==e.certNo)e.msg="请先实名认证",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else{var a={customerNameCN:e.customerNameCN,mobileNo:e.mobileNo,certNo:e.certNo},t=angular.toJson(a);o.go("addBank",{josnObj:t})}}):($(".payCardlist_null").css("display","none"),$(".payCardlist_card").css("display","block"),""==e.cardNo&""==e.bankCardType?(e.BANKNAME=t[0].BANKNAME,e.CARDNAME=t[0].CARDNAME,e.cardNum=t[0].ACCOUNTNO,e.ACCOUNTNO=t[0].ACCOUNTNO.substring(t[0].ACCOUNTNO.length-4,t[0].ACCOUNTNO.length),$(".payCardlist_card span").text(e.BANKNAME+e.CARDNAME+"(尾号"+e.ACCOUNTNO+")")):(e.cardNum=e.cardNo,$(".payCardlist_card span").text(e.bankCardType)))}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})},e.paymentMethod(),e.changeCard=function(){var a=$("#pre_money").val(),t={customerNameCN:e.customerNameCN,mobileNo:e.mobileNo,certNo:e.certNo,dataType:"5",money:a,payType:"2"},s=angular.toJson(t);o.go("paymentMethod",{josnObj:s})},e.balanceRechargeNext=function(){var a=$("#pre_money").val(),o=/^\d+(\.\d+)?$/.test(a);""==$("#pre_money").val()?(e.msg="充值金额不可为空",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):1==o?($(".topUpAmount").val(fmoney(a,2)),$("#bankPhoneCode-view .balanceRecharge").css("display","none"),$("#bankPhoneCode-view .phoneMessage").css("display","block")):(e.msg="金额格式错误",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},e.balanceRechargeCode=function(){var a,o=$("#pre_money").val(),t=$(".cardNum").text();a="accountNo="+encryptByDES(t)+"&amount="+o+"&channelType=005&customerNo="+e.customerNo+"&payType=26";var s={};s.channelType="005",s.payType="26",s.customerNo=e.customerNo,s.amount=o,s.accountNo=encryptByDES(t),s.sessionId=e.sessionId,s.signKey=publicKeyRSA(md5(a)),$.ajax({url:getRootPath()+"/ThridPayAccountAction.bankCardRechargeByQuick.do?FAPView=JSON",type:"post",data:s,success:function(a){0==(a=$.parseJSON(a)).FAPStatus?1==a.success?(sendMessage(),e.order_no=a.data.order_no,$(".getCode .orderNum").text(e.order_no),a.data.authenticate_status,e.msg=a.data.errMsg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):(e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):2==a.FAPStatus?loginH5Host():(e.msg=a.data.errMsg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})},e.ConfirmPay=function(){curCount=0;var a,t=$(".getCode .msgCode").val(),s=$(".cardNum").text(),r=$(".getCode .orderNum").text(),n=$("#pre_money").val();if(a="accountNo="+encryptByDES(s)+"&amount="+n+"&customerNo="+e.customerNo+"&orderSerialNo="+r+"&payValidateCode="+encryptByDES(t),""!==t){var c={};c.customerNo=e.customerNo,c.orderSerialNo=r,c.sessionId=e.sessionId,c.accountNo=encryptByDES(s),c.payValidateCode=encryptByDES(t),c.amount=n,c.signKey=publicKeyRSA(md5(a)),$.ajax({url:getRootPath()+"/ThridPayAccountAction.bankCardRechargeByQuickConfirm.do?FAPView=JSON",type:"post",data:c,success:function(a){0==(a=$.parseJSON(a)).FAPStatus?1==a.success?0==a.data.tradeStatus?(e.msg="账户余额充值成功",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3),o.go("accountBalance",{jsonAccountObj:i,jsonPayObj:m})):1==a.data.tradeStatus?(e.msg="交易正在处理",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):(e.msg=a.data.errMsg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):(e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})}else e.msg="短信验证码不能为空",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)},s.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function transactionDetailsCtrl(e,a,o,t){function s(e,a,o,t){$.ajax({url:e,type:"post",data:a,success:function(e){o(e)},error:function(e,a){t(e)}})}e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data"),$(".empty img").attr("src",imgRrc+"h5images/icon_wujilu@3x.png");var r=new Date;e.beginDate=getNowFormatDate(r.getFullYear()-1),e.endDate=getNowFormatDate(r.getFullYear());var n=getRootPath()+"/AccountAction.accTradeQuery.do?FAPView=JSON";e.lists=[],e.day=[];var i=1;e.noMorePage=!1,e.$on("$ionicView.loaded",function(a,o){i=1,e.noMorePage=!1,$(".list").html(""),s(n,{customerNo:e.customerNo,sessionId:e.sessionId,beginDate:e.beginDate,endDate:e.endDate,beginPos:i,pageSize:10,accType:"01",orderBy:"3",trsType:""},function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success){var o=a.data.accTradeList.result;0==o.length?($(".empty").show(),$(".emptyTwo").hide(),$(".empty img").attr("src",imgRrc+"h5images/icon_wujilu@3x.png")):(e.lists=o,e.message(e.lists))}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},function(e,a){})}),e.message=function(a){for(var o=0;o<a.length;o++){var t=a[o].createTime.substr(0,4)+"/"+a[o].createTime.substr(4,2)+"/"+a[o].createTime.substr(6,2);e.day.push(new Date(t).getDay());var s=new Date(t).getDay();1==s?e.week="周一":2==s?e.week="周二":3==s?e.week="周三":4==s?e.week="周四":5==s?e.week="周五":6==s?e.week="周六":0==s&&(e.week="周日"),e.tradeAmount=fmoney(a[o].amount,2),"0"==a[o].tradeFlg||"1"==a[o].tradeFlg?e.state="成功":e.state="交易失败";var r=a[o].trsType,n=a[o].accountType,i=a[o].tradeFlg;"00"==r?"03"==n?(e.img=imgRrc+"h5images/icon_chongzhi"+variable+".png",e.transactionType="预付卡充值支出"):"02"==n?(e.img=imgRrc+"h5images/icon_chongzhi"+variable+".png",e.transactionType="余额充值"):"01"==n&&(e.img=imgRrc+"h5images/icon_chongzhi"+variable+".png",e.transactionType="余额充值"):"10"==r?"03"==n?(e.img=imgRrc+"h5images/icon_shoujirecharge"+variable+".png",e.transactionType="全时通卡消费支出"):"02"==n?(e.img=imgRrc+"h5images/icon_shoujirecharge"+variable+".png",e.transactionType="钱包充值"):"01"==n&&(e.img=imgRrc+"h5images/icon_shoujirecharge"+variable+".png",e.transactionType="余额消费"):"20"==r?"0"==i?(e.img=imgRrc+"h5images/icon_zhuanzhang"+variable+".png",e.transactionType="转账-收入"):(e.img=imgRrc+"h5images/icon_zhuanzhang"+variable+".png",e.transactionType="转账-转给别人"):"30"==r||"60"==r||"41"==r||"42"==r||"43"==r||"40"==r||"80"==r||("81"==r?(e.img=imgRrc+"h5images/icon_shoujirecharge"+variable+".png",e.transactionType="手机充值"):"82"==r?(e.img=imgRrc+"h5images/icon_shenghuojiaofei_record"+variable+".png",e.transactionType="生活缴费"):"83"==r&&(e.img=imgRrc+"h5images/icon_shenghuojiaofei_record"+variable+".png",e.transactionType="手机流量充值")),$(".list").append("<li><span class='one'><img src='"+e.img+"'></span><p><label>"+e.tradeAmount+"</label><i>"+e.transactionType+e.tradeAmount+"元</i></p><b>"+e.week+"<br>"+a[o].createTime.substr(4,2)+"-"+a[o].createTime.substr(6,2)+"</b><em style='color: #FC5050;''>"+e.state+"</em></li>")}},e.doRefresh=function(){i=1,e.noMorePage=!1,$(".list").html(""),s(n,{customerNo:e.customerNo,sessionId:e.sessionId,beginDate:e.beginDate,endDate:e.endDate,beginPos:i,pageSize:10},function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success){var o=a.data.accTradeList.result;0==o.length?($(".empty").show(),$(".emptyTwo").hide()):(e.lists=o,e.message(e.lists))}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3));e.$broadcast("scroll.refreshComplete")},function(e){})},e.loadMore=function(){i+=10,$(".list").html(""),s(n,{customerNo:e.customerNo,sessionId:e.sessionId,beginDate:e.beginDate,endDate:e.endDate,beginPos:i,pageSize:10},function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success){var o=a.data.accTradeList.result.length;o<10&&(e.noMorePage=!0,0==o&&($(".empty").hide(),$(".emptyTwo").show()));for(var t=0;t<o;t++)e.lists.push(a.data.accTradeList.result[t]);e.message(e.lists),e.$apply()}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3));e.$broadcast("scroll.infiniteScrollComplete")},function(e,a){})},t.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function addBankCtrl(e,a,o,t){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data");var s=angular.fromJson(o.josnObj);e.customerNameCN=s.customerNameCN,e.mobile=s.mobile,e.certNo=s.certNo,e.phone=e.certNo.substr(0,4)+"***********"+e.certNo.substr(14,3),$(".addBank .bank_Num").css("background-image","url("+imgRrc+"h5images/icon_wodeyinhangka"+variable+".png)"),$(".addBank .bank_Card").css("background-image","url("+imgRrc+"h5images/icon_idcard_realname"+variable+".png)"),$(".addBank .bank_phone").css("background-image","url("+imgRrc+"h5images/icon_tel_drak"+variable+".png)"),$(".bankCardNum").blur(function(){if(""==$(this).val())e.msg="银行卡不可为空",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else{if(1==/^(\d{16}|\d{17}|\d{18}|\d{19})$/.test($(this).val())){var a={};a.cardNo=encryptByDES($(this).val()),$.ajax({url:getRootPath()+"/AccountAction.getCardInf.do?FAPView=JSON",type:"post",data:a,success:function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success){var o=a.data.cardtype;$(".savingsDeposit").show(),$(".submitBut").css("opacity",1),"0"==o?($(".savingsDeposit input").val("储蓄卡/"+a.data.bankName),$(".creditCard").hide(),e.submitBut=function(){e.addBankBtn(0)}):"1"==o&&($(".savingsDeposit input").val("信用卡/"+a.data.bankName),$(".creditCard").show(),e.submitBut=function(){e.addBankBtn(1)})}else"卡号没有对应carben"==a.errors.msg?(e.msg="不支持此银行卡的绑定",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):(e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3));else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})}else e.msg="银行卡号格式错误",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)}}),e.addBankBtn=function(a){$(".submitBut").css("opacity","0.4").attr("disabled","true");var o=e.customerNameCN,t=e.certNo,s=$(".bankCardPhone").val(),r=$(".bankCardNum").val(),n=$(".bankCardDate").val(),i=$(".bankCardCvv").val(),c=Math.floor(10*Math.random()+1),l=/^1[34578][0-9]{9}$/.test(s);if(""==s)e.msg="手机号不可为空",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3),$(".submitBut").css("opacity","1").removeAttr("disabled");else if(0==l)e.msg="手机号格式错误",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3),$(".submitBut").css("opacity","1").removeAttr("disabled");else{var m={};m.channelType="004",m.payType="26",m.customerNo=e.customerNo,m.accountNo=encryptByDES(r),m.custNm=o,m.mobile=encryptByDES(s),m.isFlag="0",m.settFlg="0",m.sessionId=e.sessionId,m.certno=encryptByDES(t),m.ctftype="1",m.trcNo=c,1==a?(m.expiryDate=n,m.cvv=encryptByDES(i),""==n||""==i?(e.msg="有效期及cvv码不可为空",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3),$(".submitBut").css("opacity","1").removeAttr("disabled")):e.addBank(m)):e.addBank(m)}},e.addBank=function(o){$.ajax({url:getRootPath()+"/ThridPayAccountAction.bankCardBindByQuick.do?FAPView=JSON",type:"post",data:o,success:function(o){o=$.parseJSON(o);$(".submitBut").css("opacity","1").removeAttr("disabled"),0==o.FAPStatus?1==o.success?(e.msg="添加银行卡成功",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3),a.go("home")):(e.msg=o.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):2==o.FAPStatus?loginH5Host():(e.msg=o.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})},t.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function agreementCtrl(e,a){}function bankListCtrl(e,a,o,t){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data");var s=angular.fromJson(a.josnObj);e.customerNameCN=s.customerNameCN,e.mobile=s.mobileNo,e.certNo=s.certNo,$(".empty img").attr("src",imgRrc+"h5images/icon_wujilu@3x.png"),$(".bankList li").off("click").live("click",function(){$(".mask").show()}),$(".mask .bottom").off("click").on("click",function(){$(".mask").hide()}),e.initListBank=function(){var a={};a.customerNo=e.customerNo,a.sessionId=e.sessionId,a.beginPos=1,a.pageSize=10,$.ajax({url:getRootPath()+"/AccountAction.bankAccListQuery.do?FAPView=JSON",type:"post",data:a,success:function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success)if(e.bankcard_list=a.data.perBankAccInfList.result,e.bank_num=e.bankcard_list.length,e.$apply(),e.bank_num>0){$(".bankList").show().siblings().hide();for(var o=0;o<e.bankcard_list.length;o++){var t=e.bankcard_list[o].bafAccountno,s=e.bankcard_list[o].bankName;"0"==e.bankcard_list[o].bafAcctype?$(".bankList ul li").eq(o).find(".bankType").text("储蓄卡"):$(".bankList ul li").eq(o).find(".bankType").text("信用卡");var r="";r=bankCard(s,r);for(var n=t.substring(6,t.length-4),i=t.substr(0,6)+n.replace(n,"*********")+t.substr(t.length-4,4),c=[],l=0;l<i.length;l++)l%4==0&&c.push(i.substr(l,4));if(5==c.length)m=c[0]+" "+c[1]+" "+c[2]+" "+c[3]+" "+c[4];else var m=c[0]+" "+c[1]+" "+c[2]+" "+c[3];$(".bankList ul li").eq(o).find(".bankName").text(s),$(".bankList ul li").eq(o).find(".bankNum").text(m),$(".bankList ul li").eq(o).find("p img").attr("src",r)}}else $(".bankList").hide().siblings().show();else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})},e.initListBank(),e.addBank=function(){var a={certNo:e.certNo,customerNameCN:e.customerNameCN,mobileNo:e.mobile},t=angular.toJson(a);o.go("addBank",{josnObj:t})},t.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function supportCtrl(e,a){$("#support-view span img").attr("src",imgRrc+"h5images/icon_bank_hsb"+variable+".png"),$(".couponsTab span").off("click").on("click",function(){var a=$(this).index();$(this).siblings("p").css("left",1.8*a+"rem"),$("#support-view ul").html(""),e.initSupport()}),e.initSupport=function(){$.ajax({url:getRootPath()+"/ThridPayAccountAction.cjtGetPaychannelFromLocal.do?FAPView=JSON",type:"post",success:function(a){if(0==(a=$.parseJSON(a)).FAPStatus){var o=[],t=[];if(1==a.success){for(var s=0;s<a.data.payList.length;s++)"DC"==a.data.payList[s].cardType?o.push(a.data.payList[s]):t.push(a.data.payList[s]);if("0px"==$(".couponsTab p").css("left"))for(var r=0;r<o.length;r++){var n="",i=o[r].instName;n=bankCard(i,n),$("#support-view ul").append('<li data-type="2"><span><img src="'+n+'"></span><p><label>'+o[r].instName+"</label><i>单笔"+o[r].cardAttribute+" 单日"+o[r].ext+"</i></p></li>")}else for(var c=0;c<t.length;c++){var n="",i=t[c].instName;n=bankCard(i,n),$("#support-view ul").append('<li data-type="2"><span><img src="'+n+'"></span><p><label>'+t[c].instName+"</label><i>单笔"+t[c].cardAttribute+" 单日"+t[c].ext+"</i></p></li>")}}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)}else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})},e.initSupport(),a.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function applyCardCtrl(e,a,o,t,s){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data");var r=angular.fromJson(a.josnObj),n=r.customerNameCN,i=r.mobileNo,c=r.certNo;t({method:"POST",url:getRootPath()+"/EcardAction.getCardProductDef.do?FAPView=JSON",data:{}}).success(function(a){0==a.FAPStatus?0==a.success?(e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):($(".applyCard div img").attr("src",imgRrc+"h5images/icon_applyfor_qstcard.png"),e.cardSelect=a.data.list[0].name,e.information=function(){e.informations(e.cardSelect)}):2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))}),e.informations=function(e){var a={certNo:c,customerNameCN:n,mobile:i,cardSelect:e},t=angular.toJson(a);o.go("information",{josnObj:t})},s.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function applyCardListCtrl(e,a,o){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data");var t=angular.fromJson(a.jsonPayObj);e.orderno=t.orderno;var s={};s.orderno=e.orderno,$.ajax({url:getRootPath()+"/EcardAction.getCardInfDetail.do?FAPView=JSON",data:s,success:function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(0==a.success)e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else{e.list=a.list;for(var o=0;o<e.list.length;o++)"已绑卡"==e.list[o].status?$(".notActive").css("background","#bbb"):"冻结"==e.list[o].status?$(".notActive").css("background","#B8C9E0"):"锁定"==e.list[o].status?$(".notActive").css("background","#E6B8AE"):"退卡"==e.list[o].status?$(".notActive").css("background","#A4A6BA"):"销毁"==e.list[o].status?$(".notActive").css("background","#D2BDA8"):$(".notActive").css("background","#EA5532")}else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}}),o.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function applyCardRecordsCtrl(e,a){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data"),$(".empty img").attr("src",imgRrc+"h5images/icon_wujilu@3x.png"),$(".applyCardRecords img").attr("src",imgRrc+"h5images/icon_qstcard_yue"+variable+".png");var o={};o.customerNo=e.customerNo,$.ajax({url:getRootPath()+"/EcardAction.queryCardList.do?FAPView=JSON",data:o,success:function(a){0==(a=$.parseJSON(a)).FAPStatus?0==a.list.length?$(".empty").show().siblings().hide():$(".empty").hide().siblings().show():2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}}),a.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function applyOrderCtrl(e,a,o,t,s){$(".applyOrder h2 img").attr("src",imgRrc+"h5images/icon_zhuannext_money_w"+variable+".png"),e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data");var r=angular.fromJson(a.josnObj);e.customerNameCN=r.customerNameCN,e.mobile=r.mobile,e.certNo=r.certNo,e.cardSelect=r.cardSelect;var n=angular.fromJson(a.jsonPayObj);e.number=n.number,e.money=n.money,e.dillName=n.dillName,e.isDill=n.isDill,e.dataType="5",e.payType="1",e.moneys=e.money*parseInt(e.number);var i=new Date;e.beginDate=getNowFormatDate(i.getFullYear()),e.time=e.beginDate.substr(0,4)+"/"+e.beginDate.substr(4,2)+"/"+e.beginDate.substr(6,2),0==e.isDill?e.invoiceJudge=!1:e.invoiceJudge=!0,e.modify=function(){var a={certNo:e.certNo,customerNameCN:e.customerNameCN,mobileNo:e.mobile},t=angular.toJson(a);o.go("information",{josnObj:t})},$(".applyPay").off("click").on("click",function(){$(this).attr("disabled","true").css("opacity","0.4");var a={};a.userId=e.customerNo,a.cardType=e.cardSelect,a.cardNum=e.number,a.isDill=e.isDill,a.dillName=e.dillName,a.totalPayAmount=e.moneys,a.amount=e.money,$.ajax({url:getRootPath()+"/EcardAction.confirmCardOrder.do?FAPView=JSON",data:a,success:function(a){$(".applyPay").removeAttr("disabled");if(0==(a=$.parseJSON(a)).FAPStatus)if(0==a.success)e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else{var t=a.data.orderno,s={amount:e.money,orderno:t,certNo:e.certNo,customerNameCN:e.customerNameCN,mobileNo:e.mobile,dataType:e.dataType,money:e.moneys,payType:e.payType},r=angular.toJson(s);o.go("applyPay",{josnObj:r})}else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){$(".applyPay").removeAttr("disabled")}})}),s.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function applyPayPasswordCtrl(e,a,o,t){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data");var s=angular.fromJson(a.josnObj);e.customerNameCN=s.customerNameCN,e.mobile=s.mobile,e.certNo=s.certNo;var r=angular.fromJson(a.jsonPayObj);e.cardNo=r.cardNo,e.money=r.money,e.orderno=r.orderno,e.amount=r.amount,e.moneys=fmoney(e.money,2),e.obtainCode=function(){$(".submitBut").css("opacity","1"),$(".messageCode").attr("disabled","true").css({background:"#ccc",border:"none",color:"#fff"});var a="accountNo="+encryptByDES(e.cardNo)+"&channelType=005&customNo="+e.customerNo+"&initAmt="+e.money+"&orderNo="+e.orderno+"&payType=3",o={};o.orderNo=e.orderno,o.initAmt=e.money,o.channelType="005",o.accountNo=encryptByDES(e.cardNo),o.customNo=e.customerNo,o.payType="26",o.signKey=publicKeyRSA(md5(a)),$.ajax({url:getRootPath()+"/EcardAction.cardRecharge.do?FAPView=JSON",data:o,success:function(a){$(".messageCode").removeAttr("disabled").css({background:"none",border:"1px solid #333",color:"#333"});if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success)if(1==a.data.authenticate_status)e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else{sendMessage();var o=a.data.orderno,t=a.data.scoorderno;e.submitBut=function(){curCount=0,e.paySubmit(o,t)}}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){$(".messageCode").removeAttr("disabled").css({background:"none",border:"1px solid #333",color:"#333"})}})},e.paySubmit=function(a,t){$(".submitBut").attr("disabled","true").css("opacity","0.4");var s=$(".obtainCode input").val(),r=e.amount,n="amount="+r+"&author="+e.customerNo+"&enterbank="+encryptByDES(e.cardNo)+"&orderno="+a+"&payType=3&payValidateCode="+encryptByDES(s)+"&scoorderno="+t;if(""==s)e.msg="验证码不可为空",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else{var i={};i.author=e.customerNo,i.payValidateCode=encryptByDES(s),i.scoorderno=t,i.enterbank=encryptByDES(e.cardNo),i.amount=r,i.payType="3",i.orderno=a,i.signKey=publicKeyRSA(md5(n)),$.ajax({url:getRootPath()+"/EcardAction.cardOrderAudit.do?FAPView=JSON",data:i,success:function(t){$(".submitBut").removeAttr("disabled").css("opacity","1");if(0==(t=$.parseJSON(t)).FAPStatus)if(1==t.success)if(1==t.data.authenticate_status)e.msg=t.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else{var s={amount:t.data.amount,orderno:a,cardnum:t.data.cardnum,createTime:t.data.createTime,money:e.money},r=angular.toJson(s);o.go("applySuccess",{josnObj:r})}else e.msg=t.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==t.FAPStatus?loginH5Host():(e.msg=t.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){$(".submitBut").removeAttr("disabled").css("opacity","1")}})}},t.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function applySuccessCtrl(e,a,o,t){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data");var s=angular.fromJson(a.josnObj);e.amount=s.amount,e.orderno=s.orderno,e.certNo=s.cardnum,e.createTime=s.createTime,e.money=s.money,e.moneys=fmoney(e.money,2),e.createDate=e.createTime.substr(0,4)+"-"+e.createTime.substr(4,2)+"-"+e.createTime.substr(6,2)+" "+e.createTime.substr(8,2)+":"+e.createTime.substr(10,2)+":"+e.createTime.substr(12,2),$(".applySuccess p img").attr("src",imgRrc+"h5images/zhuanzhang"+variable+".png"),e.many=function(){var a={orderno:e.orderno},t=angular.toJson(a);o.go("applyCardList",{jsonPayObj:t})}}function informationCtrl(e,a,o,t,s){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data");var r=angular.fromJson(t.josnObj),n=r.customerNameCN,i=r.mobile,c=r.certNo,l=r.cardSelect;e.denomination=function(){$(".informationMask").show(),$(".selectDenomination").animate({bottom:"0"})},$(".choice").off("click").on("click",function(){$(".informationMask").hide(),$(".selectDenomination").animate({bottom:"-2.8rem"}),$(".denomination input").val($(this).text()),$(".next").css("opacity","1")}),e.close=function(){$(".informationMask").hide(),$(".selectDenomination").animate({bottom:"-2.8rem"})},$(".invoiceJudge input").off("click").on("click",function(){"yes"==$(this).attr("data-type")?($(".invoiceTitle").show(),$(".invoiceNum").show()):"no"==$(this).attr("data-type")&&($(".invoiceTitle").hide(),$(".invoiceNum").show())});var m,d,u;a({method:"POST",url:getRootPath()+"/EcardAction.getCardProductCount.do?FAPView=JSON",data:{}}).success(function(a){if(0==a.FAPStatus)if(1==a.success){var o;o=0==a.data.list.length?5:a.data.list[0].numberr<=5?a.data.list[0].numberr:5,$(".reduce").off("click").on("click",function(){$(".buyCardsNum").val()<=1?$(".buyCardsNum").val(1):$(".buyCardsNum").val(parseInt($(".buyCardsNum").val())-1)}),$(".plus").off("click").on("click",function(){$(".buyCardsNum").val()>=o?$(".buyCardsNum").val(5):$(".buyCardsNum").val(parseInt($(".buyCardsNum").val())+1)}),$(".buyCardsNum").blur(function(){$(".buyCardsNum").val()<=1?$(".buyCardsNum").val(1):$(".buyCardsNum").val()>=o&&$(".buyCardsNum").val(5)})}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))}).error(function(e,a,o){}),e.applyOrder=function(){if("1"!=$(".next").css("opacity"))return e.msg="请选择购卡面额",e.openModalThree(),void setTimeout(function(){e.closeModalThree()},3e3);if("yes"==$(".invoiceJudge input:checked").attr("data-type")){if(m=1,d=$(".invoiceTitle input").val(),u=$(".invoiceNum input").val(),""==d||""==u)return e.msg="请输入发票抬头或发票税号！",e.openModalThree(),void setTimeout(function(){e.closeModalThree()},3e3)}else m=0,d="",u="";var a={certNo:c,customerNameCN:n,mobile:i,cardSelect:l},t=angular.toJson(a),s={money:$(".denomination input").val(),number:$(".buyCardsNum").val(),dillName:d,isDill:m},r=angular.toJson(s);o.go("applyOrder",{josnObj:t,jsonPayObj:r})},s.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function instructionsCtrl(e,a){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data")}function applyCreditCardCtrl(e,a,o,t,s){$("#applyCreditCard-view .jinru_back").css("background-image","url("+imgRrc+"h5images/icon_jinru_black"+variable+".png)"),$("#applyCreditCard-view .list .item .img01").css("background-image","url("+imgRrc+"h5images/icon_bank_zggsyh"+variable+".png)"),$("#applyCreditCard-view .list .item .img02").css("background-image","url("+imgRrc+"h5images/icon_bank_zggdyh"+variable+".png)"),$("#applyCreditCard-view .list .item .img03").css("background-image","url("+imgRrc+"h5images/icon_bank_payh"+variable+".png)"),$("#applyCreditCard-view .list .item .img04").css("background-image","url("+imgRrc+"h5images/icon_bank_pfyh"+variable+".png)"),$("#applyCreditCard-view .list .item .img05").css("background-image","url("+imgRrc+"h5images/icon_bank_xyyh"+variable+".png)"),a.goGongShangBank=function(){o.go("GongShangBank")},a.paySrcGongShang=t.trustAsResourceUrl("https://mims.icbc.com.cn/IMServiceServer/servlet/ICBCBaseReqNSServlet?dse_operationName=ApplyCreditCardOp&coreCode=HZDW000007461&paraPromoCode=EW888020000070014700"),a.goGuangDaBank=function(){o.go("guangDaBank")},a.paySrcGuangDa=t.trustAsResourceUrl("https://xyk.cebbank.com/cebmms/apply/ps/card-list.htm?level=124&pro_code=FHTG023524SJ303XMRO"),a.goPingAnBank=function(){o.go("pingAnBank")},a.paySrcPingAn=t.trustAsResourceUrl("https://c.pingan.com/apply/mobile/apply/index.html?scc=230000588&ccp=1a2a3a4a8a13a9&showt=1&xl=01a02a03a04a05"),a.goPuFaBank=function(){o.go("puFaBank")},a.paySrcPuFa=t.trustAsResourceUrl("https://ecentre.spdbccc.com.cn/creditcard/indexActivity.htm?data=P1479932"),a.goXingYeBank=function(){o.go("xingYeBank")},a.paySrcXingYe=t.trustAsResourceUrl("https://ccshop.cib.com.cn:8010/application/cardapp/cappl/ApplyCard/toSelectCard?id=265d3950fd8c4ec59bdea5ee98bdd35c")}function billListCtrl(e,a,o,t,s,r,n){function i(e,a,o,t){$.ajax({url:e,type:"post",data:a,success:function(e){o(e)},error:function(e,a){t(e)}})}e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data");var c=new Date;e.beginDate=getNowFormatDate(c.getFullYear()-1),e.endDate=getNowFormatDate(c.getFullYear());var l=getRootPath()+"/ThridPayAccountAction.myOrderTradeQuery.do?FAPView=JSON";e.lists=[];var m=1;e.noMorePage=!1,e.day=[],e.$on("$ionicView.loaded",function(a,o){m=1,e.noMorePage=!1,$(".list").html(""),i(l,{customerNo:e.customerNo,sessionId:e.sessionId,beginDate:e.beginDate,endDate:e.endDate,limit:10,orderBy:4,page:m},function(a){0==(a=$.parseJSON(a)).FAPStatus?1==a.success?0==a.data.orderTradeList.length?($(".empty").show(),$(".emptyTwo").hide(),$(".empty img").attr("src",imgRrc+"h5images/icon_wujilu@3x.png")):(e.lists=a.data.orderTradeList,e.message(e.lists)):(e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},function(e,a){})}),e.doRefresh=function(){m=1,e.noMorePage=!1,$(".list").html(""),i(l,{customerNo:e.customerNo,sessionId:e.sessionId,beginDate:e.beginDate,endDate:e.endDate,limit:10,orderBy:4,page:m},function(a){0==(a=$.parseJSON(a)).FAPStatus?1==a.success?0==a.data.orderTradeList.length?($(".empty").show(),$(".emptyTwo").hide()):(e.lists=a.data.orderTradeList,e.message(e.lists)):(e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)),e.$broadcast("scroll.refreshComplete")},function(e,a){})},e.loadMore=function(){m+=10,$(".list").html(""),i(l,{customerNo:e.customerNo,sessionId:e.sessionId,beginDate:e.beginDate,endDate:e.endDate,limit:10,orderBy:4,page:m},function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success){var o=a.data.orderTradeList.length;o<10&&(e.noMorePage=!0,0==o&&($(".empty").hide(),$(".emptyTwo").show()));for(var t=0;t<o;t++)e.lists.push(a.data.orderTradeList[t]);e.message(e.lists),e.$apply()}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3));e.$broadcast("scroll.infiniteScrollComplete")},function(e,a){})},e.message=function(a){for(var o=0;o<a.length;o++){var t=a[o].createTime.substr(0,4)+"/"+a[o].createTime.substr(5,2)+"/"+a[o].createTime.substr(8,2);e.day.push(new Date(t).getDay());var s=new Date(t).getDay();1==s?e.week="周一":2==s?e.week="周二":3==s?e.week="周三":4==s?e.week="周四":5==s?e.week="周五":6==s?e.week="周六":0==s&&(e.week="周日"),e.trxAmount=fmoney(a[o].trxAmout,2),"成功"==a[o].orderStatus?e.state="交易成功":"失败"==a[o].orderStatus?e.state="交易失败":e.state="等待支付";var r=a[o].orderType;if("支付"==r)e.img=imgRrc+"h5images/icon_shoujirecharge"+variable+".png",e.transactionType="支付";else if("充值"==r)e.img=imgRrc+"h5images/icon_chongzhi"+variable+".png",e.transactionType="余额充值";else if("转账"==r)e.img=imgRrc+"h5images/icon_zhuanzhang"+variable+".png",e.transactionType="转账";else if("手机充值"==r)e.img=imgRrc+"h5images/icon_shoujirecharge"+variable+".png",e.transactionType="手机充值";else if("83"==r||"手机流量充值"==r)e.img=imgRrc+"h5images/icon_shoujirecharge"+variable+".png",e.transactionType="手机流量充值";else if("生活缴费"==r){var n=a[o].remark;"水费缴费"==n?(e.img=imgRrc+"h5images/icon_life_water24"+variable+".png",e.transactionType="水费缴费"):"电费缴费"==n?(e.img=imgRrc+"h5images/icon_life_electric24"+variable+".png",e.transactionType="电费缴费"):(e.img=imgRrc+"h5images/icon_life_fire24"+variable+".png",e.transactionType="燃气缴费")}$(".list").append("<li><span class='one water'><img src='"+e.img+"'></span><p><label>－"+e.trxAmount+"</label><i>"+e.transactionType+e.trxAmount+"元</i></p><b>"+e.week+"<br>"+a[o].createTime.substr(5,2)+"-"+a[o].createTime.substr(8,2)+"</b><em style='color: #FC5050;''>"+e.state+"</em></li>")}},r.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function cardBalanceQueryCtrl(e,a){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data"),$("#cardBalanceQuery-view .cardBalanceQuery .lock").css("background-image","url("+imgRrc+"h5images/icon_kahao"+variable+".png)"),$("#cardBalanceQuery-view .cardBalanceQuery .passwordka").css("background-image","url("+imgRrc+"h5images/icon_mima_black"+variable+".png)"),e.fullCardsQuery=function(){var a=$("#cardBalanceQuery-view .fullCardNum").val(),o=$("#cardBalanceQuery-view .fullCardPsW").val(),t=/^(\d{19})\s*$/.test(a),s=/^\d{6}\s*$/.test(o);if(""==o||""==a)e.msg="全时通卡号或卡密码不可为空",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else if(1==s&&1==t){var r={};r.customerNo=e.customerNo,r.sessionId=e.sessionId,r.cardNo=a,r.cardPayPwd=o,$.ajax({url:getRootPath()+"/PrepaidCardAction.prepaidCardBalQuery.do?FAPView=JSON",type:"post",data:r,success:function(o){0==(o=$.parseJSON(o)).FAPStatus?1==o.success?(e.availableBalance=o.data.availableBalance,e.msg=e.availableBalance,e.cardNumber=a.substring(15,a.length),e.openModalFour(),e.sureQueryFun=function(){e.closeModalFour()}):(e.msg=o.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):(e.msg=o.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})}else e.msg="请输入正确的全时通卡卡号或卡密码",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)},a.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()},a.fromTemplateUrl("templates/modalFour.html",{scope:e}).then(function(a){e.modalFour=a}),e.openModalFour=function(){e.modalFour.show()},e.closeModalFour=function(){e.modalFour.hide()}}function couponsCtrl(e,a,o){function t(a,o){var t={};t.customerNo=e.customerNo,t.sessionId=e.sessionId,t.beginPos=a,t.pageSize=2,t.status=o,$.ajax({url:getRootPath()+"/PublicPayAction.findCouponList.do?FAPView=JSON",data:t,success:function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success)for(var t=a.data.couponList.result,s="",r="",n=(a.data.couponList.pages,0);n<t.length;n++)s=t[n].expiredate,r=t[n].cdiIssdate,couponDirection=t[n].couponDirection,couponFrom=t[n].couponFrom,"01"==o?($("#couponsCanuse").append('<li><p class="money"><span><i>'+t[n].couponAmount+'</i>元</span><label>优惠券</label></p><p class="time"><span>有效期：'+r+"-"+s+"</span><label><b></b><em>"+couponDirection+"</em></label><big>来源：<i>"+couponFrom+"</i></big></p></li>"),$("#coupons-view .couponsList li").css("background-image","url("+imgRrc+"h5images/icon_quan_canused"+variable+".png)").find(".time span").css("color","#E53D1F").siblings("label").find("b").css("background-color","#E53D1F")):"02"==o?($("#couponsUsed").append('<li><p class="money"><span><i>'+t[n].couponAmount+'</i>元</span><label>优惠券</label></p><p class="time"><span>有效期：'+r+"-"+s+"</span><label><b></b><em>"+couponDirection+"</em></label><big>来源：<i>"+couponFrom+"</i></big></p></li>"),$("#coupons-view .couponsList li").css("background-image","url("+imgRrc+"h5images/icon_quan_yishiyong"+variable+".png)").find(".time span").css("color","#999").siblings("label").find("b").css("background-color","#999")):($("#couponsExpired").append('<li><p class="money"><span><i>'+t[n].couponAmount+'</i>元</span><label>优惠券</label></p><p class="time"><span>有效期：'+r+"-"+s+"</span><label><b></b><em>"+couponDirection+"</em></label><big>来源：<i>"+couponFrom+"</i></big></p></li>"),$("#coupons-view .couponsList li").css("background-image","url("+imgRrc+"h5images/icon_quan_yiguoqi"+variable+".png)").find(".time span").css("color","#999").siblings("label").find("b").css("background-color","#999"));else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})}e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data"),$("#coupons-view .couponsList li").css("background-image","url("+imgRrc+"h5images/icon_quan_canused"+variable+".png)"),$(".couponsTab span").off("click").on("click",function(){$(".couponsList ul").eq($(this).index()).css("display","block").siblings().css("display","none");var e=$(this).index();$(this).siblings("p").css("left",1.28*e+"rem");0==e?($("#couponsCanuse").html(""),t(1,"01"),$("#coupons-view .couponsList li").css("background-image","url("+imgRrc+"h5images/icon_quan_canused"+variable+".png)").find(".time span").css("color","#E53D1F").siblings("label").find("b").css("background-color","#E53D1F")):1==e?($("#couponsUsed").html(""),t(1,"02"),$("#coupons-view .couponsList li").css("background-image","url("+imgRrc+"h5images/icon_quan_yishiyong"+variable+".png)").find(".time span").css("color","#999").siblings("label").find("b").css("background-color","#999")):($("#couponsExpired").html(""),t(1,"99"),$("#coupons-view .couponsList li").css("background-image","url("+imgRrc+"h5images/icon_quan_yiguoqi"+variable+".png)").find(".time span").css("color","#999").siblings("label").find("b").css("background-color","#999"))}),t(1,"01"),$(".couponsList li").off("click").on("click",function(){"0px"==$(".couponsTab p").css("left")&&$("#coupons-view .mask").show()}),$(".maskContent button").off("click").on("click",function(){$(this).parents(".mask").hide()}),o.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function addFullCardCtrl(e,a,o,t,s){$("#addFulltimeCard-view .addFullCardNum .lockCard").css("background-image","url("+imgRrc+"h5images/icon_kahao"+variable+".png)"),$("#addFulltimeCard-view .addFullCardNum .lockPass").css("background-image","url("+imgRrc+"h5images/icon_mima_black"+variable+".png)"),e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data");var r=angular.fromJson(t.josnObj);e.certNo=r.certNo,e.mobileNo=r.mobileNo,e.customerNameCN=r.customerNameCN;var n={certNo:e.certNo,mobileNo:e.mobileNo,customerNameCN:e.customerNameCN},i=(angular.toJson(n),{aifavabalance:e.aifavabalance,fullCardNo:e.fullCardNo,bankCardType:e.bankCardType});angular.toJson(i);e.addFullCard=function(){var t=$("#fullCardNum").val(),s=$("#fullCardPassword").val();if(""!=t&&""!=s){var r={};r.customerNo=e.customerNo,r.sessionId=e.sessionId,r.cardNo=encryptByDES(t),r.cardPayPwd=encryptByDES(s),$.ajax({url:getRootPath()+"/PrepaidCardAction.prepaidCardAdd.do?FAPView=JSON",type:"post",data:r,success:function(t){0==(t=$.parseJSON(t)).FAPStatus?1==t.success?(e.msg="您的全时通卡已添加成功",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3),a.clearCache(),o.go("fullTimeCard")):(e.msg=t.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):2==t.FAPStatus?loginH5Host():(e.msg=t.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})}else e.msg="全时通卡号及密码不可为空",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)},s.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function balanFullTimeCardCtrl(e,a,o,t,s){$("#balanFullTimeCard-view .balanFullTimeCardImg").attr("src",imgRrc+"h5images/quanshitongka_n"+variable+".png"),e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data"),e.certNo=localStorage.getItem("certNoData");var r=angular.fromJson(t.josnObj);e.aifavabalance=r.aifavabalance,e.fullCardNo=r.fullCardNo;var n={};n.customerNo=e.customerNo,n.sessionId=e.sessionId,$.ajax({url:getRootPath()+"/CustomerAction.custInfoQuery.do?FAPView=JSON",type:"post",data:n,success:function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success){var t=a.data.certNo,s=a.data.customerNameCN,r=a.data.mobileNo;e.customerNameCN=s,e.mobileNo=r,e.certNo=t;var n={cardNo:"",bankCardType:"",fullCardNo:e.fullCardNo,certNo:e.certNo,mobileNo:e.mobileNo,customerNameCN:e.customerNameCN},i=angular.toJson(n);e.toRechfullTimeCard=function(){o.go("rechfullTimeCard",{josnObj:i})},e.fullCardTraDetailsFun=function(){o.go("fullCardTraDetails",{josnObj:i})}}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}}),e.showDelFullCard=function(){e.openModalFive()},e.sureDelFullCard=function(){var t={};t.customerNo=e.customerNo,t.sessionId=e.sessionId,t.cardNo=e.fullCardNo,t.symbol=0,t.passWord=1,$.ajax({url:getRootPath()+"/PrepaidCardAction.prepaidCardDelete.do?FAPView=JSON",type:"post",data:t,success:function(t){0==(t=$.parseJSON(t)).FAPStatus?1==t.success?(e.msg="您的全时通卡已成功删除",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3),e.closeModalFive(),a.clearCache(),o.go("fullTimeCard")):(e.msg=t.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):2==t.FAPStatus?loginH5Host():(e.msg=t.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})},e.closeDelFullCard=function(){e.closeModalFive()},s.fromTemplateUrl("templates/modalFive.html",{scope:e}).then(function(a){e.modalFive=a}),e.openModalFive=function(){e.modalFive.show()},e.closeModalFive=function(){e.modalFive.hide()},s.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function fullCardTraDetailsCtrl(e,a,o,t){function s(e,a,o,t){$.ajax({url:e,type:"post",data:a,success:function(e){o(e)},error:function(e,a){t(e)}})}e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data"),$(".empty img").attr("src",imgRrc+"h5images/icon_wujilu@3x.png");var r=new Date;e.beginDate=getNowFormatDate(r.getFullYear()-1),e.endDate=getNowFormatDate(r.getFullYear());var n=angular.fromJson(o.josnObj);e.fullCardNo=n.fullCardNo;var i=getRootPath()+"/AccountAction.accPreTradeQuery.do?FAPView=JSON";e.lists=[],e.day=[];var c=1;e.noMorePage=!1,e.$on("$ionicView.loaded",function(a,o){c=1,e.noMorePage=!1,$(".list").html(""),s(i,{customerNo:e.customerNo,sessionId:e.sessionId,beginDate:e.beginDate,endDate:e.endDate,beginPos:c,pageSize:10,accType:"03",orderBy:"3",trsType:"",cardNo:e.fullCardNo},function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success){var o=a.data.accTradeList.result;0==o.length?($(".empty").show(),$(".emptyTwo").hide(),$(".empty img").attr("src",imgRrc+"h5images/icon_wujilu@3x.png")):(e.lists=o,e.message(e.lists))}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},function(e,a){})}),e.message=function(a){for(var o=0;o<a.length;o++){var t=a[o].createTime.substr(0,4)+"/"+a[o].createTime.substr(4,2)+"/"+a[o].createTime.substr(6,2);e.day.push(new Date(t).getDay());var s=new Date(t).getDay();1==s?e.week="周一":2==s?e.week="周二":3==s?e.week="周三":4==s?e.week="周四":5==s?e.week="周五":6==s?e.week="周六":0==s&&(e.week="周日"),e.tradeAmount=fmoney(a[o].amount,2),"0"==a[o].tradeFlg||"1"==a[o].tradeFlg?e.state="成功":e.state="交易失败";var r=a[o].trsType,n=a[o].accountType,i=a[o].tradeFlg;"00"==r?"03"==n?(e.img=imgRrc+"h5images/icon_chongzhi"+variable+".png",e.transactionType="预付卡充值支出"):"02"==n?(e.img=imgRrc+"h5images/icon_chongzhi"+variable+".png",e.transactionType="余额充值"):"01"==n&&(e.img=imgRrc+"h5images/icon_chongzhi"+variable+".png",e.transactionType="余额充值"):"10"==r?"03"==n?(e.img=imgRrc+"h5images/icon_shoujirecharge"+variable+".png",e.transactionType="全时通卡消费支出"):"02"==n?(e.img=imgRrc+"h5images/icon_shoujirecharge"+variable+".png",e.transactionType="钱包充值"):"01"==n&&(e.img=imgRrc+"h5images/icon_shoujirecharge"+variable+".png",e.transactionType="余额消费"):"20"==r?"0"==i?(e.img=imgRrc+"h5images/icon_zhuanzhang"+variable+".png",e.transactionType="转账-收入"):(e.img=imgRrc+"h5images/icon_zhuanzhang"+variable+".png",e.transactionType="转账-转给别人"):"30"==r?(e.img=imgRrc+"h5images/icon_zhuanzhang"+variable+".png",e.transactionType="全时通卡退款"):"60"==r?(e.img=imgRrc+"h5images/icon_zhuanzhang"+variable+".png",e.transactionType="提现"):"41"==r?(e.img=imgRrc+"h5images/icon_zhuanzhang"+variable+".png",e.transactionType="消费"):"42"==r?(e.img=imgRrc+"h5images/icon_zhuanzhang"+variable+".png",e.transactionType="消费撤销"):"43"==r?(e.img=imgRrc+"h5images/icon_zhuanzhang"+variable+".png",e.transactionType="消费冲正"):"40"==r?(e.img=imgRrc+"h5images/icon_zhuanzhang"+variable+".png",e.transactionType="全时通卡充值"):"80"==r?(e.img=imgRrc+"h5images/icon_zhuanzhang"+variable+".png",e.transactionType="缴费"):"81"==r?(e.img=imgRrc+"h5images/icon_shoujirecharge"+variable+".png",e.transactionType="手机充值"):"82"==r?(e.img=imgRrc+"h5images/icon_shenghuojiaofei_record"+variable+".png",e.transactionType="生活缴费"):"83"==r&&(e.img=imgRrc+"h5images/icon_shenghuojiaofei_record"+variable+".png",e.transactionType="手机流量充值"),$(".list").append("<li><span class='one'><img src='"+e.img+"'></span><p><label>"+e.tradeAmount+"</label><i>"+e.transactionType+e.tradeAmount+"元</i></p><b>"+e.week+"<br>"+a[o].createTime.substr(4,2)+"-"+a[o].createTime.substr(6,2)+"</b><em style='color: #FC5050;''>"+e.state+"</em></li>")}},e.doRefresh=function(){c=1,e.noMorePage=!1,$(".list").html(""),s(i,{customerNo:e.customerNo,sessionId:e.sessionId,beginDate:e.beginDate,endDate:e.endDate,beginPos:c,pageSize:10,accType:"03",orderBy:"3",trsType:"",cardNo:e.fullCardNo},function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success){var o=a.data.accTradeList.result;0==o.length?($(".empty").show(),$(".emptyTwo").hide()):(e.lists=o,e.message(e.lists))}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3));e.$broadcast("scroll.refreshComplete")},function(e){})},e.loadMore=function(){c+=10,$(".list").html(""),s(i,{customerNo:e.customerNo,sessionId:e.sessionId,beginDate:e.beginDate,endDate:e.endDate,beginPos:c,pageSize:10,accType:"03",orderBy:"3",trsType:"",cardNo:e.fullCardNo},function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success){var o=a.data.accTradeList.result.length;o<10&&(e.noMorePage=!0,0==o&&($(".empty").hide(),$(".emptyTwo").show()));for(var t=0;t<o;t++)e.lists.push(a.data.accTradeList.result[t]);e.message(e.lists),e.$apply()}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3));e.$broadcast("scroll.infiniteScrollComplete")},function(e,a){})},t.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function fullTimeCardCtrl(e,a,o,t,s){$("#balanFullTimeCard-view .balanFullTimeCardImg").attr("src",imgRrc+"h5images/icon_qstcard_yue"+variable+".png"),$("#rechfullTimeCard-view .rechfullTimeCard .rechargeNum").css("background-image","url("+imgRrc+"h5images/jine"+variable+".png)"),$("#fullTimeCard-view .transDetail img").attr("src",imgRrc+"h5images/icon_kashu_qstcard"+variable+".png"),$("#fullTimeCard-view .addFullCard").css("background-image","url("+imgRrc+"h5images/icon_addqstcard"+variable+".png)"),$("#fullTimeCard-view .noneCard").css("background-image","url("+imgRrc+"h5images/icon_wuka"+variable+".png)"),e.isApp=getURLParameter("isApp"),"1"==e.isApp?e.isAppFlag=!0:e.isAppFlag=!1,e.onFullCardBackFun=function(){callHandler("onFullCardBackApp",{isApp:"1"},function(e){})},e.loginH5Host=function(){var a={};a.loginname=loginName,a.channel="1001",a.token="";var o="loginname="+loginName+"&channel=1001&token=",t=md5(o+"&"+md5("12345678").toUpperCase()).toUpperCase();a.md5info=t,$.ajax({url:getRootPath()+"/BusinessEntraceAction.loginH5Host.do?FAPView=JSON",data:a,success:function(a){var o=(a=$.parseJSON(a)).FAPErrorMessage;if(0==a.FAPStatus)if(1==a.success){var t=a.data.sessionId,s=a.data.payPwd,r=a.data.trueNameStatus,n=a.data.customerName,i=a.data.mobile,c=a.data.certNo;localStorage.setItem("data",t),localStorage.setItem("payPwdData",s),localStorage.setItem("trueNameStatusData",r),localStorage.setItem("customerNameData",n),localStorage.setItem("mobileData",i),localStorage.setItem("certNoData",c),e.init()}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():1==a.FAPStatus&&(e.msg=o,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})},e.loginH5Host(),e.init=function(){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data");var a={};a.customerNo=e.customerNo,a.sessionId=e.sessionId,$.ajax({url:getRootPath()+"/CustomerAction.custInfoQuery.do?FAPView=JSON",type:"post",data:a,success:function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success){var t=a.data.certNo,s=a.data.customerNameCN,r=a.data.mobileNo;e.customerNameCN=s,e.mobileNo=r,e.certNo=t;var n={certType:e.certType,customerNameCN:e.customerNameCN,mobileNo:e.mobileNo,certNo:e.certNo},i=angular.toJson(n);e.addFullCards=function(){o.go("addFullCard",{josnObj:i})},e.cardListInit()}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})},e.cardListInit=function(){e.sessionId=localStorage.getItem("data");var a={};a.customerNo=e.customerNo,a.sessionId=e.sessionId,a.beginPos=1,a.pageSize=10,$.ajax({url:getRootPath()+"/AccountAction.preCardListQuery.do?FAPView=JSON",type:"post",cache:!1,data:a,success:function(a){if(0==(a=$.parseJSON(a)).FAPStatus&&1==a.success)if(e.resultQshi=a.data.perPreCardInfList.result,e.$apply(),0==e.resultQshi.length)$("#fullTimeCard-view .noneCard").css("display","block"),$("#fullTimeCard-view .noneCardDetail").css("display","block");else{$("#fullTimeCard-view .cardList").css("display","block");for(var t=0,s=0;s<e.resultQshi.length;s++){var r=e.resultQshi[s].cardNo,n=r.substr(6,9),i=r.substr(0,6)+n.replace(n,"*********")+r.substr(15,4);$(".cardList").append('<li><p class="balanceNum"><b>'+fmoney(e.resultQshi[s].aifavabalance,2)+'</b></p><p class="cardNum">'+i+'</p><p class="cardNumberQshiNum" style="display: none;">'+r+"</p></li>"),s>=3?t=1:t++,$("#fullTimeCard-view .cardList li").eq(s).css({"background-image":"url("+imgRrc+"h5images/ka"+t+variable+".png)","background-repeat":"no-repeat"}),$("#fullTimeCard-view .cardList li").off("click").live("click",function(){var e={aifavabalance:$(this).find(".balanceNum b").text(),fullCardNo:$(this).find(".cardNumberQshiNum").text()},a=angular.toJson(e);o.go("balanFullTimeCard",{josnObj:a})})}}},error:function(e,a,o){}})},s.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function rechfullTimeCardCtrl(e,a,o,t,s){$("#balanFullTimeCard-view .balanFullTimeCardImg").attr("src",imgRrc+"h5images/icon_qstcard_yue"+variable+".png"),$("#rechfullTimeCard-view .rechfullTimeCard .rechargeNum").css("background-image","url("+imgRrc+"h5images/jine"+variable+".png)"),$("#fullTimeCard-view .transDetail img").attr("src",imgRrc+"h5images/icon_kashu_qstcard"+variable+".png"),$("#fullTimeCard-view .addFullCard").css("background-image","url("+imgRrc+"h5images/icon_addqstcard"+variable+".png)"),$("#fullTimeCard-view .noneCard").css("background-image","url("+imgRrc+"h5images/icon_wuka"+variable+".png)"),e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data"),e.certNo=localStorage.getItem("certNoData");var r=angular.fromJson(t.josnObj);e.certNo=r.certNo,e.mobileNo=r.mobileNo,e.customerNameCN=r.customerNameCN,e.fullCardNo=r.fullCardNo,e.bankCardType=r.bankCardType,e.cardNo=r.cardNo,e.fullCardNum=e.fullCardNo.substr(15,4),e.paymentMethod=function(){var a={};a.customerNo=e.customerNo,$.ajax({url:getRootPath()+"/PrepaidCardAction.cardQuery.do?FAPView=JSON",type:"post",data:a,success:function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success){var t=a.data.bankcard;a.data.cdcard;0==a.data.bankcard.length?($(".payCardlist_null").css("display","block"),$(".payCardlist_card").css("display","none"),e.addBankView=function(){if(""==e.certNo)e.msg="请先实名认证",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else{var a={customerNameCN:e.customerNameCN,mobileNo:e.mobileNo,certNo:e.certNo},t=angular.toJson(a);o.go("addBank",{josnObj:t})}}):($(".payCardlist_null").css("display","none"),$(".payCardlist_card").css("display","block"),""==e.cardNo&""==e.bankCardType?(e.fullCardNum=e.fullCardNo.substr(15,4),e.BANKNAME=t[0].BANKNAME,e.CARDNAME=t[0].CARDNAME,e.bankCardNum=t[0].ACCOUNTNO,e.ACCOUNTNO=t[0].ACCOUNTNO.substring(t[0].ACCOUNTNO.length-4,t[0].ACCOUNTNO.length),$(".payCardlist_card span").text(e.BANKNAME+e.CARDNAME+"("+e.ACCOUNTNO+")")):(e.bankCardNum=e.cardNo,e.fullCardNum=e.fullCardNo.substr(15,4),$(".payCardlist_card span").text(e.bankCardType)))}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})},e.paymentMethod(),e.changeCard=function(){var a=$("#pre_money").val(),t={cardNo:e.cardNo,fullCardNo:e.fullCardNo,bankCardType:e.bankCardType,certNo:e.certNo,mobile:e.mobileNo,customerNameCN:e.customerNameCN,dataType:"5",money:a,payType:"3"},s=angular.toJson(t);o.go("fullCardPayMethod",{josnObj:s})},e.nextPhoneCode=function(){var a=$("#pre_money").val(),o=/^\d+(\.\d+)?$/.test(a);""==$("#pre_money").val()?(e.msg="充值金额不可为空",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):1==o?($(".topUpAmount").val(fmoney(a,2)),$("#rechfullTimeCard-view .balanceRecharge").css("display","none"),$("#rechfullTimeCard-view .phoneMessage").css("display","block")):(e.msg="金额格式错误",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},e.balanceRechargeCode=function(){var a=$("#pre_money").val(),o=$(".bankCardHao").text(),t="accountNo="+encryptByDES(o)+"&cardNo="+encryptByDES(e.fullCardNo)+"&channelType=005&customNo="+e.customerNo+"&initAmt="+a+"&payType=26",s={};s.customNo=e.customerNo,s.sessionId=e.sessionId,s.cardNo=encryptByDES(e.fullCardNo),s.initAmt=a,s.channelType="005",s.accountNo=encryptByDES(o),s.payType="26",s.signKey=publicKeyRSA(md5(t)),$.ajax({url:getRootPath()+"/PublicPayAction.cardRechargeByQuick.do?FAPView=JSON",type:"post",data:s,success:function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success)if(1==a.data.authenticateStatus)e.msg=a.data.errMsg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else{sendMessage();var o=a.data.orderno,t=a.data.flowno;$(".orderNo").text(o),$(".flowno").text(t)}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?(loginH5Host(),$(".change").off("click").live("click",function(){$("#mark_one").css("display","none"),window.location.href="./index.html"})):(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})},e.ConfirmPay=function(){curCount=0;var t=$(".getCode .msgCode").val(),s=$(".bankCardHao").text(),r=$(".orderNo").text(),n=$(".flowno").text(),i=$("#pre_money").val();if(l="accountNo="+encryptByDES(s)+"&amount="+i+"&customerNo="+e.customerNo+"&orderSerialNo="+r+"&payValidateCode="+encryptByDES(t),""!==t)if(""==r)e.msg="请点击获取短信验证码",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else{var c={},l="cardNo="+encryptByDES(e.fullCardNo)+"&customNo="+e.customerNo+"&flowno="+n+"&orderno="+r+"&payValidateCode="+encryptByDES(t)+"&recordedBank="+encryptByDES(s);c.customNo=e.customerNo,c.sessionId=e.sessionId,c.cardNo=encryptByDES(e.fullCardNo),c.orderno=r,c.flowno=n,c.payValidateCode=encryptByDES(t),c.recordedBank=encryptByDES(s),c.signKey=publicKeyRSA(md5(l)),$.ajax({url:getRootPath()+"/PublicPayAction.payMentAuth.do?FAPView=JSON",type:"post",data:c,success:function(t){if(0==(t=$.parseJSON(t)).FAPStatus)if(1==t.success)if(0==t.data.tradeStatus){e.msg="全时通卡余额充值成功",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);var s={certNo:e.certNo,mobileNo:e.mobileNo,customerNameCN:e.customerNameCN},r=angular.toJson(s);a.clearCache(),o.go("fullTimeCard",{josnObj:r})}else 1==t.data.tradeStatus?(e.msg="交易正在处理",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):(e.msg=t.data.errMsg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3));else e.msg=t.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==t.FAPStatus||(e.msg=t.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})}else e.msg="短信验证码不能为空",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)},s.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function homeCtrl(e,a,o,t,s,r){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data"),e.payPwd=localStorage.getItem("payPwdData");var n=$(".mainEntr .col-center img");$(".baseInfor").css("background-image","url("+imgRrc+"h5images/icon-rukou-backgroud"+variable+".png)"),$(".rukouStar").css("background-image","url("+imgRrc+"h5images/icon-rukou-star"+variable+".png)"),$(".homeFooter p img").attr("src",imgRrc+"h5images/icon-rukou-logo"+variable+".png");for(var i=0;i<n.length;i++)$(".mainEntr .col-center img").eq(i).attr("src",imgRrc+"h5images/icon-"+(i+1)+variable+".png");$("#settings-view .headPortrait img").attr("src",imgRrc+"h5images/icon_head_image"+variable+".png"),$("#home-view .jinru_back").css("background-image","url("+imgRrc+"h5images/icon_jinru_black"+variable+".png)"),$("#home-view .myBills img").attr("src",imgRrc+"h5images/icon-4"+variable+".png"),$("#home-view .setPayPswds img").attr("src",imgRrc+"h5images/icon-9"+variable+".png"),e.loginH5Host=function(){var a={};a.loginname=loginName,a.channel="1001",a.token="";var o="loginname="+loginName+"&channel=1001&token=",t=md5(o+"&"+md5("12345678").toUpperCase()).toUpperCase();a.md5info=t,$.ajax({url:getRootPath()+"/BusinessEntraceAction.loginH5Host.do?FAPView=JSON",data:a,success:function(a){var o=(a=$.parseJSON(a)).FAPErrorMessage;if(0==a.FAPStatus)if(1==a.success){var t=a.data.sessionId,s=a.data.payPwd,r=a.data.trueNameStatus,n=a.data.customerName,i=a.data.mobile,c=a.data.certNo;localStorage.setItem("data",t),localStorage.setItem("payPwdData",s),localStorage.setItem("trueNameStatusData",r),localStorage.setItem("customerNameData",n),localStorage.setItem("mobileData",i),localStorage.setItem("certNoData",c),e.init()}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():1==a.FAPStatus&&(e.msg=o,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})},e.loginH5Host(),e.init=function(){var t={};t.customerNo=e.customerNo,$.ajax({url:getRootPath()+"/PrepaidCardAction.cardBalQuery.do?FAPView=JSON",type:"post",data:t,success:function(t){if(0==(t=$.parseJSON(t)).FAPStatus)if(1==t.success){e.accountBalance=fmoney(t.data.bankLists.avaAccountBalance,2),e.balance_wrap=fmoney(t.data.bankLists.avaBalance,2),e.bankList=t.data.bankList,e.bankLists=t.data.bankLists,e.card_num=e.bankList.length,e.$digest(),e.trueName=localStorage.getItem("trueNameStatusData"),e.customerName=localStorage.getItem("customerNameData"),e.mobile=localStorage.getItem("mobileData"),e.certNo=localStorage.getItem("certNoData");var r={certType:e.certNo,customerNameCN:e.customerName,mobileNo:e.mobile,certNo:e.certNo},n=angular.toJson(r);e.toSettingsFun=function(){o.go("settings",{jsonObj:n})},$(".mainEntr .col").off("click").on("click",function(){!function(a,t,r,n,i){var c={certNo:t,customerNameCN:n,mobileNo:i},l=angular.toJson(c),m=angular.toJson("");if("0"==r)s.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a,e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}),e.msg="请先实名认证",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else{if("coupons"==a.attr("data-type")&&o.go("coupons"),"bankList"==a.attr("data-type")&&o.go("bankList",{josnObj:l}),"sweepTheYard"==a.attr("data-type")&&(m=angular.toJson({fullCardNo:""}),o.go("sweepTheYard",{jsonPayObj:m})),"cardBalanceQuery"==a.attr("data-type")&&o.go("cardBalanceQuery"),"billList"==a.attr("data-type")&&o.go("billList"),"transfer"==a.attr("data-type")&&o.go("transfer"),"applyCard"==a.attr("data-type")&&o.go("applyCard",{josnObj:l}),"inviteCode"==a.attr("data-type")&&o.go("inviteCode"),"setPayPswd"==a.attr("data-type")&&o.go("setPayPswd",{josnObj:l}),"waterElectricityFuelGas"==a.attr("data-type")){e.text=a.find("p").text(),e.type=a.find("p").attr("data-type");var d={};d.customerNo=e.customerNo,$.ajax({url:getRootPath()+"/PayHydropowerSetupAction.findPayHydropowerSetupList.do?FAPView=JSON",type:"post",data:d,success:function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success){if("1"==e.type)if(0==a.data.shuiList.length){var t={text:e.text,type:e.type,phsid:e.type,message:"",city:"北京",ptdCardNo:""},s=angular.toJson(t);o.go("jiaofeiRecord",{waterJsonObj:s})}else{e.list=a.data.shuiList;var t={list:e.list,text:e.text,type:e.type,phsid:e.type,message:"",city:"北京",ptdCardNo:e.ptdCardNo},s=angular.toJson(t);o.go("waterElectricityFuelGas",{waterJsonObj:s})}else if("2"==e.type)if(0==a.data.dianList.length){var t={text:e.text,type:e.type,phsid:e.type,message:"",city:"北京",ptdCardNo:""},s=angular.toJson(t);o.go("jiaofeiRecord",{waterJsonObj:s})}else{e.list=a.data.dianList;var t={list:e.list,text:e.text,type:e.type,phsid:e.type,message:"",city:"北京",ptdCardNo:e.ptdCardNo},s=angular.toJson(t);o.go("waterElectricityFuelGas",{waterJsonObj:s})}else if("3"==e.type)if(0==a.data.meiList.length){var t={text:e.text,type:e.type,phsid:e.type,message:"",city:"北京",ptdCardNo:""},s=angular.toJson(t);o.go("jiaofeiRecord",{waterJsonObj:s})}else{e.list=a.data.meiList;var t={list:e.list,text:e.text,type:e.type,phsid:e.type,message:"",city:"北京",ptdCardNo:e.ptdCardNo},s=angular.toJson(t);o.go("waterElectricityFuelGas",{waterJsonObj:s})}}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})}"phoneRecharge"==a.attr("data-type")&&o.go("phoneRecharge",{josnObj:l}),"applyCreditCard"==a.attr("data-type")&&o.go("applyCreditCard")}}($(this),e.certNo,e.trueName,e.trueName,e.mobile)}),$(".fullTimeCard").off("click").on("click",function(){o.go("fullTimeCard")}),$(".accountBalance").off("click").on("click",function(){o.go("accountBalance")}),e.myBillsFun=function(){o.go("billList")},e.setPayPswdFun=function(){objpswd={certNo:e.certNo,customerNameCN:e.customerNameCN,mobileNo:e.mobileNo};var t=angular.toJson(objpswd);a.clearCache(),o.go("setPayPswd",{josnObj:t})}}else e.msg=t.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==t.FAPStatus?loginH5Host():(e.msg=t.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})},e.goBackApp=function(){function e(e){if(!!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)){if(window.WebViewJavascriptBridge)return e(WebViewJavascriptBridge);if(window.WVJBCallbacks)return window.WVJBCallbacks.push(e);window.WVJBCallbacks=[e];var a=document.createElement("iframe");a.style.display="none",a.src="wvjbscheme://__BRIDGE_LOADED__",document.documentElement.appendChild(a),setTimeout(function(){document.documentElement.removeChild(a)},0)}else window.WebViewJavascriptBridge?e(WebViewJavascriptBridge):document.addEventListener("WebViewJavascriptBridgeReady",function(){e(WebViewJavascriptBridge)},!1)}!function(a,o,t){e(function(e){e.callHandler(a,o,t)})}("goBack",{code:"00"},function(e){})},s.fromTemplateUrl("templates/modalSix.html",{scope:e}).then(function(a){e.modalSix=a,e.openModalSix=function(){e.modalSix.show()},e.closeModalSix=function(){e.modalSix.hide()},""==e.payPwd&&(e.openModalSix(),e.closeSetPswd=function(){e.closeModalSix()},e.sureSetPswd=function(){o.go("setPayPswd"),e.closeModalSix()})}),s.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function inviteCodeCtrl(e,a,o,t){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data"),e.inviteCode=e.customerNo.substr(6,4),e.inviteCodeOne=e.inviteCode.substr(0,1),e.inviteCodeTwo=e.inviteCode.substr(1,1),e.inviteCodeThree=e.inviteCode.substr(2,1),e.inviteCodeFour=e.inviteCode.substr(3,1);var s={};s.customerNo=e.customerNo,s.sessionId=e.sessionId,$.ajax({url:getRootPath()+"/CustomerAction.myInvitationList.do?FAPView=JSON",data:s,success:function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success){0==a.data.myInvitationList.length?($(".empty img").attr("src",imgRrc+"h5images/icon_wujilu@3x.png"),$(".invitationList").hide().siblings().show()):$(".invitationList").show().siblings().hide()}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})}function payMessageCtrl(e,a,o,t){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data");var s=angular.fromJson(a.josnObj);e.customerNameCN=s.customerNameCN,e.mobile=s.mobileNo,e.certNo=s.certNo;var r=angular.fromJson(a.jsonPayObj);e.cardNo=r.cardNo,e.money=r.money,e.mobile=r.mobile,e.sellPrice=r.sellPrice,e.areaName=r.areaName,e.carrierName=r.carrierName,e.ppiId=r.ppiId,e.payType=r.payType,e.moneys=fmoney(e.sellPrice,2),e.obtainCode=function(){$(".submitBut").css("opacity","1"),$(".messageCode").attr("disabled","true").css({background:"#ccc",border:"none",color:"#fff"});var a={},o="amount="+e.money+"&areaName="+e.areaName+"&cardNo="+encryptByDES(e.cardNo)+"&carrierName="+e.carrierName+"&customerNo="+e.customerNo+"&mobileNo="+encryptByDES(e.mobile)+"&paychannel=004&payPassword="+encryptByDES("")+"&payType="+e.payType+"&ppiId="+e.ppiId+"&sellPrice="+e.sellPrice;a.customerNo=e.customerNo,a.sessionId=e.sessionId,a.mobileNo=encryptByDES(e.mobile),a.amount=e.money,a.sellPrice=e.sellPrice,a.payType=e.payType,a.cardNo=encryptByDES(e.cardNo),a.ppiId=e.ppiId,a.areaName=e.areaName,a.carrierName=e.carrierName,a.payPassword=encryptByDES(""),a.paychannel="002",a.signKey=publicKeyRSA(md5(o)),$.ajax({url:getRootPath()+"/ChargingPaymentAction.mobileRechargeCreateBill.do?FAPView=JSON",data:a,success:function(a){$(".messageCode").removeAttr("disabled").css({background:"none",border:"1px solid #333",color:"#333"});if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success)if(1==a.data.authenticate_status)e.msg=a.data.errMsg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else{sendMessage();var o=a.data.tranflow;e.submitBut=function(){curCount=0,e.paySubmit(o)}}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){$(".messageCode").removeAttr("disabled").css({background:"none",border:"1px solid #333",color:"#333"})}})},e.paySubmit=function(a){$(".submitBut").attr("disabled","true").css("opacity","0.4");var t=$(".obtainCode input").val();if(""==t)e.msg="验证码不可为空",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else{var s="amount="+e.money+"&cardNo="+encryptByDES(e.cardNo)+"&customerNo="+e.customerNo+"&mobileNo="+encryptByDES(e.mobile)+"&payType="+e.payType+"&ppiId="+e.ppiId+"&sellPrice="+e.sellPrice+"&tranFlowNo="+a+"&verificationCode="+encryptByDES(t),r={};r.customerNo=e.customerNo,r.sessionId=e.sessionId,r.mobileNo=encryptByDES(e.mobile),r.amount=e.money,r.sellPrice=e.sellPrice,r.payType=e.payType,r.cardNo=encryptByDES(e.cardNo),r.tranFlowNo=a,r.ppiId=e.ppiId,r.verificationCode=encryptByDES(t),r.signKey=publicKeyRSA(md5(s)),$.ajax({url:getRootPath()+"/ChargingPaymentAction.mobileRechargeConfirm.do?FAPView=JSON",data:r,success:function(a){$(".submitBut").removeAttr("disabled").css("opacity","1");if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success)if(1==a.data.payPaymentStatus)e.msg=a.data.errMsg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else{var t={sellPrice:e.sellPrice,goodsInf:a.data.transactionOrderDetail.goodsInf,mobile:e.mobile,amount:e.money,merchName:a.data.transactionOrderDetail.merchName,createTime:a.data.transactionOrderDetail.createTime,orderNo:a.data.transactionOrderDetail.orderNo,orderStatus:a.data.transactionOrderDetail.orderStatus},s=angular.toJson(t);o.go("topUpSuccess",{josnObj:s})}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){$(".submitBut").removeAttr("disabled").css("opacity","1")}})}}}function payMessageFlowCtrl(e,a,o,t){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data"),e.customerNameCN=localStorage.getItem("customerNameData"),e.mobile=localStorage.getItem("mobileData"),e.certNo=localStorage.getItem("certNoData");var s=angular.fromJson(a.jsonPayObj);e.type=s.type,"1"==e.type?e.state="全国":"2"==e.type&&(e.state="本地"),e.moneys=s.money,e.cardNo=s.cardNo,e.bankCardType=s.bankCardType,e.productId=s.productId,e.flow=s.flow,e.payType=s.payType,e.mobilePhone=s.mobilePhone,e.obtainCode=function(){$(".submitBut").css("opacity","1"),$(".messageCode").attr("disabled","true").css({background:"#ccc",border:"none",color:"#fff"});var a={},o="cardNo="+encryptByDES(e.cardNo)+"&customerNo="+e.customerNo+"&flow="+e.flow+"&mobileNo="+e.mobilePhone+"&paychannel=008&payPassword="+encryptByDES("")+"&payType=26&productId="+e.productId+"&type="+e.type;a.customerNo=e.customerNo,a.sessionId=e.sessionId,a.cardNo=encryptByDES(e.cardNo),a.flow=e.flow,a.mobileNo=e.mobilePhone,a.payPassword=encryptByDES(""),a.payType="26",a.paychannel="008",a.productId=e.productId,a.type=e.type,a.signKey=publicKeyRSA(md5(o)),$.ajax({url:getRootPath()+"/GagaAction.requestCreateOrder.do?FAPView=JSON",data:a,success:function(a){$(".messageCode").removeAttr("disabled").css({background:"none",border:"1px solid #333",color:"#333"});if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success)if(1==a.data.payPaymentStatus)e.msg=a.data.errMsg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else{sendMessage();var o=a.data.tranflow;a.data.transactionOrderDetail.trxAmount;localStorage.setItem("tranflowLiuLiangData",o),e.submitBut=function(){curCount=0,e.paySubmit(o)}}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){$(".messageCode").removeAttr("disabled").css({background:"none",border:"1px solid #333",color:"#333"})}})},e.paySubmit=function(a){$(".submitBut").attr("disabled","true").css("opacity","0.4");var t=$(".obtainCode input").val();if(e.tranflow=localStorage.getItem("tranflowLiuLiangData"),""==t)e.msg="验证码不可为空",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else{var s={};s.amount=e.moneys,s.cardNo=encryptByDES(e.cardNo),s.customerNo=e.customerNo,s.flow=e.flow,s.mobileNo=e.mobilePhone,s.payType=e.payType,s.productId=e.productId,s.smsCode=t,s.tranFlowNo=e.tranflow,s.type=e.type;var r="amount="+e.moneys+"&cardNo="+encryptByDES(e.cardNo)+"&customerNo="+e.customerNo+"&flow="+e.flow+"&mobileNo="+e.mobilePhone+"&payType="+e.payType+"&productId="+e.productId+"&smsCode="+t+"&tranFlowNo="+e.tranflow+"&type="+e.type;s.signKey=publicKeyRSA(md5(r)),$.ajax({url:getRootPath()+"/GagaAction.mobileRechargeConfirm.do?FAPView=JSON",data:s,success:function(a){$(".submitBut").removeAttr("disabled").css("opacity","1");if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success)if(1==a.data.payPaymentStatus)e.msg=a.data.errMsg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else{var t=a.data.transactionOrderDetail.orderStatus,s=a.data.transactionOrderDetail.goodsInf,r=a.data.transactionOrderDetail.trxAmount,n=a.data.transactionOrderDetail.rcvCstName,i=a.data.transactionOrderDetail.createTime,c=a.data.transactionOrderDetail.orderNo,l={money:r,mobile:e.mobilePhone,orderStatus:t,goodsInf:s,rcvCstName:n,createTime:i,orderNo:c},m=angular.toJson(l);setTimeout(function(){o.go("topUpSuccess",{josnObj:m})},2e3)}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){$(".submitBut").removeAttr("disabled").css("opacity","1")}})}},t.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function payPasswordCtrl(e,a,o,t){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data");var s=angular.fromJson(a.josnObj);e.customerNameCN=s.customerNameCN,e.mobileNo=s.mobileNo,e.certNo=s.certNo;var r=angular.fromJson(a.jsonPayObj);e.cardNo=r.cardNo,e.money=r.money,e.mobile=r.mobile,e.sellPrice=r.sellPrice,e.areaName=r.areaName,e.carrierName=r.carrierName,e.ppiId=r.ppiId,e.payType=r.payType,e.moneys=fmoney(e.sellPrice,2),$(".payPassword h3 img").attr("src",imgRrc+"h5images/icon_zhuannext_money_w"+variable+".png"),e.replace=function(){var a={certNo:e.certNo,customerNameCN:e.customerNameCN,mobileNo:e.mobileNo,mobile:e.mobile,sellPrice:e.sellPrice,ppiId:e.ppiId,areaName:e.areaName,carrierName:e.carrierName,money:e.money,dataType:"4",payType:"5"},t=angular.toJson(a);o.go("payWay",{josnObj:t})},payPassword(),$(".i-text").keyup(function(){for(var a=$(this).val(),t=a.length,s=0;s<=6;s++)$(".sixDigitPassword").find("i").eq(t).addClass("active").siblings("i").removeClass("active"),$(".sixDigitPassword").find("i").eq(t).prevAll("i").find("b").css({display:"block"}),$(".sixDigitPassword").find("i").eq(t-1).nextAll("i").find("b").css({display:"none"}),0==t?($(".sixDigitPassword").find("i").eq(0).addClass("active").siblings("i").removeClass("active"),$(".sixDigitPassword").find("b").css({display:"none"})):6==t&&($(".sixDigitPassword").find("b").css({display:"block"}),$(".sixDigitPassword").find("i").eq(5).addClass("active").siblings("i").removeClass("active"));if(6==t)if($(".mask").show().siblings(".mask_all").show().find(".mask_in").show(),1==/^\d{6}$/.test(a)){var r={},n="amount="+e.money+"&areaName="+e.areaName+"&cardNo="+encryptByDES(e.cardNo)+"&carrierName="+e.carrierName+"&customerNo="+e.customerNo+"&mobileNo="+encryptByDES(e.mobile)+"&paychannel=004&payPassword="+encryptByDES(a)+"&payType="+e.payType+"&ppiId="+e.ppiId+"&sellPrice="+e.sellPrice;r.customerNo=e.customerNo,r.sessionId=e.sessionId,r.mobileNo=encryptByDES(e.mobile),r.amount=e.money,r.sellPrice=e.sellPrice,r.payType=e.payType,r.cardNo=encryptByDES(e.cardNo),r.ppiId=e.ppiId,r.areaName=e.areaName,r.carrierName=e.carrierName,r.payPassword=encryptByDES(a),r.paychannel="004",r.signKey=publicKeyRSA(md5(n)),$.ajax({url:getRootPath()+"/ChargingPaymentAction.mobileRechargeCreateBill.do?FAPView=JSON",type:"post",data:r,success:function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success)if(0==a.data.payPaymentStatus){$(".mask_in").hide().siblings(".mask_success").show();var t={orderStatus:a.data.transactionOrderDetail.orderStatus,sellPrice:e.sellPrice,goodsInf:a.data.transactionOrderDetail.goodsInf,mobile:e.mobile,amount:e.money,merchName:a.data.transactionOrderDetail.merchName,createTime:a.data.transactionOrderDetail.createTime,orderNo:a.data.transactionOrderDetail.orderNo},s=angular.toJson(t);setTimeout(function(){$(".mask").hide(),o.go("topUpSuccess",{josnObj:s})},2e3)}else $(".login_mask").show().text(a.data.errMsg).siblings(".mask").hide().siblings(".mask_all").hide(),setTimeout(function(){$(".login_mask").hide()},2e3),$(".i-text").val(""),$(".sixDigitPassword").find("i").removeClass("active"),$(".sixDigitPassword").find("b").css({display:"none"});else $(".login_mask").show().text(a.errors.msg).siblings(".mask").hide().siblings(".mask_all").hide(),setTimeout(function(){$(".login_mask").hide()},2e3),$(".i-text").val(""),$(".sixDigitPassword").find("i").removeClass("active"),$(".sixDigitPassword").find("b").css({display:"none"});else 2==a.FAPStatus?loginH5Host():($(".login_mask").show().text(a.FAPErrorMessage).siblings(".mask").hide().siblings(".mask_all").hide(),setTimeout(function(){$(".login_mask").hide()},2e3),$(".i-text").val(""),$(".sixDigitPassword").find("i").removeClass("active"),$(".sixDigitPassword").find("b").css({display:"none"}))},error:function(e,a,o){}})}else $(".login_mask").show().text("支付密码格式错误，请重试").siblings(".mask").hide().siblings(".mask_all").hide(),setTimeout(function(){$(".login_mask").hide()},2e3)})}function payPasswordFlowCtrl(e,a,o,t){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data"),e.customerNameCN=localStorage.getItem("customerNameData"),e.mobile=localStorage.getItem("mobileData"),e.certNo=localStorage.getItem("certNoData");var s=angular.fromJson(a.jsonPayObj);e.type=s.type,"1"==e.type?e.state="全国":"2"==e.type&&(e.state="本地"),e.moneys=s.money,e.cardNo=s.cardNo,e.bankCardType=s.bankCardType,e.productId=s.productId,e.flow=s.flow,e.payType=s.payType,e.mobilePhone=s.mobilePhone,$(".payPassword h3 img").attr("src",imgRrc+"h5images/icon_zhuannext_money_w"+variable+".png"),e.replace=function(){var a={certNo:e.certNo,customerNameCN:e.customerNameCN,mobileNo:e.mobileNo,mobile:e.mobile,sellPrice:e.sellPrice,ppiId:e.ppiId,areaName:e.areaName,carrierName:e.carrierName,money:e.money,dataType:"4",payType:"5"},t=angular.toJson(a);o.go("payWay",{josnObj:t})},payPassword(),$(".i-text").keyup(function(){for(var a=$(this).val(),t=a.length,s=0;s<=6;s++)$(".sixDigitPassword").find("i").eq(t).addClass("active").siblings("i").removeClass("active"),$(".sixDigitPassword").find("i").eq(t).prevAll("i").find("b").css({display:"block"}),$(".sixDigitPassword").find("i").eq(t-1).nextAll("i").find("b").css({display:"none"}),0==t?($(".sixDigitPassword").find("i").eq(0).addClass("active").siblings("i").removeClass("active"),$(".sixDigitPassword").find("b").css({display:"none"})):6==t&&($(".sixDigitPassword").find("b").css({display:"block"}),$(".sixDigitPassword").find("i").eq(5).addClass("active").siblings("i").removeClass("active"));if(6==t)if($(".mask").show().siblings(".mask_all").show().find(".mask_in").show(),1==/^\d{6}$/.test(a)){var r={},n="cardNo="+encryptByDES(e.cardNo)+"&customerNo="+e.customerNo+"&flow="+e.flow+"&mobileNo="+e.mobile+"&paychannel=008&payPassword="+encryptByDES($(".i-text").val())+"&payType=01&productId="+e.productId+"&type="+e.type;r.customerNo=e.customerNo,r.sessionId=e.sessionId,r.cardNo=encryptByDES(e.cardNo),r.flow=e.flow,r.mobileNo=e.mobilePhone,r.payPassword=encryptByDES($(".i-text").val()),r.payType="01",r.paychannel="008",r.productId=e.productId,r.type=e.type,r.signKey=publicKeyRSA(md5(n)),$.ajax({url:getRootPath()+"/GagaAction.requestCreateOrder.do?FAPView=JSON",type:"post",data:r,success:function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success)if(0==a.data.payPaymentStatus){$(".mask_in").hide().siblings(".mask_success").show();var t=a.data.transactionOrderDetail.orderStatus,s=a.data.transactionOrderDetail.goodsInf,r=a.data.transactionOrderDetail.trxAmount,n=a.data.transactionOrderDetail.rcvCstName,i=a.data.transactionOrderDetail.createTime,c=a.data.transactionOrderDetail.orderNo,l={money:r,mobile:e.mobilePhone,orderStatus:t,goodsInf:s,rcvCstName:n,createTime:i,orderNo:c},m=angular.toJson(l);setTimeout(function(){$(".mask").hide(),o.go("topUpSuccess",{josnObj:m})},2e3)}else $(".login_mask").show().text(a.data.errMsg).siblings(".mask").hide().siblings(".mask_all").hide(),setTimeout(function(){$(".login_mask").hide()},2e3),$(".i-text").val(""),$(".sixDigitPassword").find("i").removeClass("active"),$(".sixDigitPassword").find("b").css({display:"none"});else $(".login_mask").show().text(a.errors.msg).siblings(".mask").hide().siblings(".mask_all").hide(),setTimeout(function(){$(".login_mask").hide()},2e3),$(".i-text").val(""),$(".sixDigitPassword").find("i").removeClass("active"),$(".sixDigitPassword").find("b").css({display:"none"});else 2==a.FAPStatus?loginH5Host():($(".login_mask").show().text(a.FAPErrorMessage).siblings(".mask").hide().siblings(".mask_all").hide(),setTimeout(function(){$(".login_mask").hide()},2e3),$(".i-text").val(""),$(".sixDigitPassword").find("i").removeClass("active"),$(".sixDigitPassword").find("b").css({display:"none"}))},error:function(e,a,o){}})}else $(".login_mask").show().text("支付密码格式错误，请重试").siblings(".mask").hide().siblings(".mask_all").hide(),setTimeout(function(){$(".login_mask").hide()},2e3)})}function phoneRechargeCtrl(e,a,o,t){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data");var s=angular.fromJson(a.josnObj);e.customerNameCN=s.customerNameCN,e.mobile=s.mobileNo,e.certNo=s.certNo,$("#phoneRecharge-view .jinru_back").css("background-image","url("+imgRrc+"h5images/icon_jinru_black"+variable+".png)"),e.information=!1,e.flow=!1,e.phoneList=!1,e.informationTab=[{text:"充话费"},{text:"充流量"}],$(".phone").keyup(function(){var a=$(this).val();if(11==a.length){/^1[34578][0-9]{9}$/.test(a)?($(".phoneRecharge span").show(),e.phoneHuaFeiFun=function(){var o={};o.customerNo=e.customerNo,o.sessionId=e.sessionId,o.mobileNo=a,$.ajax({url:getRootPath()+"/ChargingPaymentAction.mobileRechargeProductQuery.do?FAPView=JSON",type:"post",data:o,success:function(a){0==(a=$.parseJSON(a)).FAPStatus?1==a.success?(e.information=!0,e.phoneList=!0,e.flow=!1,e.areaName=a.data.areaName,e.carrierName=a.data.carrierName,$(".prompt").text(e.areaName+" "+e.carrierName).css("color","#333"),e.mobileRecharge=a.data.mobileRechargeProductList,e.$apply()):$(".prompt").text(a.errors.msg).css("color","red"):2==a.FAPStatus?loginH5Host():$(".prompt").text(a.FAPErrorMessage).css("color","red")},error:function(e,a,o){}})},e.phoneHuaFeiFun(),e.phoneLiuLiangFun=function(){var o={};o.mark="",o.mobileNo=a,$.ajax({url:getRootPath()+"/PhoneFlowProductInfAction.findPhoneFlowDataList.do?FAPView=JSON",type:"get",data:o,success:function(a){0==(a=$.parseJSON(a)).FAPStatus?1==a.success?e.phoneFlowList=a.data.mobileFlowProductList:$(".prompt").text(a.errors.msg).css("color","red"):2==a.FAPStatus?loginH5Host():$(".prompt").text(a.FAPErrorMessage).css("color","red")},error:function(e,a,o){}})},e.phoneLiuLiangFun(),e.DetailLi=!1,e.DetailLi02=!1,e.DetailLi03=!1,e.DetailLi04=!1,e.DetailLi05=!1,e.DetailLi06=!1,e.DetailLi07=!1,e.DetailLi08=!1,e.DetailLi09=!1,e.DetailLi10=!1,e.DetailLi11=!1,$("#phoneRecharge-view .phoneRecharge .flow .flowBox .flowTop .b1").css("background-image","url("+imgRrc+"h5images/flowUp"+variable+".png)"),$("#phoneRecharge-view .phoneRecharge .flow .flowBox .flowTop .b2").css("background-image","url("+imgRrc+"h5images/flowDown"+variable+".png)")):$(".prompt").text("手机号格式错误").css("color","red"),e.choice=function(a){0==a?($(".informationTab p").css("left","0.52rem"),e.information=!0,e.flow=!1,e.phoneList=!0):1==a&&($(".informationTab p").css("left","2.15rem"),e.information=!0,e.flow=!0,e.phoneList=!1)}}}),e.phoneRechargeAmount=function(a){$(".phoneList label").eq(a).addClass("hover").siblings().removeClass("hover");var t=$(".phoneList label").eq(a).find(".amount span").text(),s=$(".phoneList label").eq(a).find(".price").text(),r=$(".phoneList label").eq(a).find(".ppiId").text(),n=e.areaName,i=e.carrierName,c={phoneType:1,mobile:$(".phone").val(),sellPrice:s,ppiId:r,areaName:n,carrierName:i,money:t,dataType:"4",payType:"5"},l=angular.toJson(c);o.go("payWay",{josnObj:l})},e.payFloW=function(e){var a=e,t=a.currentTarget.children[3].innerHTML,s=a.currentTarget.children[4].innerHTML,r=a.currentTarget.firstElementChild.children[0].innerHTML,n=a.currentTarget.children[5].innerHTML,i={phoneType:2,mobilePhone:$(".phone").val(),moneyFlow:r,ppiId:n,flow:t,type:s,dataType:"4",payType:"5"},c=angular.toJson(i);o.go("payWay",{josnObj:c})}}function phoneRechargeRecordsCtrl(e,a){function o(e,a,o,t){$.ajax({url:e,type:"post",data:a,success:function(e){o(e)},error:function(e,a){t(e)}})}e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data"),$(".phoneRechargeRecords .one img").attr("src",imgRrc+"h5images/icon_xiaofei"+variable+".png"),$(".phoneRechargeRecords .two img").attr("src",imgRrc+"h5images/icon_shenghuojiaofei_record"+variable+".png"),$(".empty img").attr("src",imgRrc+"h5images/icon_wujilu@3x.png");var t=new Date;e.beginDate=getNowFormatDate(t.getFullYear()-1),e.endDate=getNowFormatDate(t.getFullYear());var s=getRootPath()+"/ThridPayAccountAction.myOrderTradeQuery.do?FAPView=JSON";e.lists=[];var r=1;e.noMorePage=!1,e.day=[],e.$on("$ionicView.loaded",function(a,t){r=1,e.noMorePage=!1,$(".list").html(""),o(s,{customerNo:e.customerNo,sessionId:e.sessionId,beginDate:e.beginDate,endDate:e.endDate,page:r,limit:10,orderBy:"4",selectMark:"SJ"},function(a){0==(a=$.parseJSON(a)).FAPStatus?1==a.success?0==a.data.orderTradeList.length?$(".empty").show().siblings().hide():(e.lists=a.data.orderTradeList,e.message(e.lists),$(".empty").hide().siblings().show()):(e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},function(e,a){})}),e.doRefresh=function(){r=1,e.noMorePage=!1,$(".list").html(""),o(s,{customerNo:e.customerNo,sessionId:e.sessionId,beginDate:e.beginDate,endDate:e.endDate,page:r,limit:10,orderBy:"4",selectMark:"SJ"},function(a){0==(a=$.parseJSON(a)).FAPStatus?1==a.success?0==a.data.orderTradeList.length?$(".empty").show().siblings().hide():(e.lists=a.data.orderTradeList,e.message(e.lists),$(".empty").hide().siblings().show()):(e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)),e.$broadcast("scroll.refreshComplete")},function(e,a){})},e.loadMore=function(){r+=1,$(".list").html(""),o(s,{customerNo:e.customerNo,sessionId:e.sessionId,beginDate:e.beginDate,endDate:e.endDate,page:r,limit:10,orderBy:"4",selectMark:"SJ"},function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success){var o=a.data.orderTradeList.length;o<10&&(e.noMorePage=!0,0==o&&$(".empty").show().siblings().hide());for(var t=0;t<o;t++)e.lists.push(a.data.orderTradeList[t]);e.message(e.lists),e.$apply()}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3));e.$broadcast("scroll.infiniteScrollComplete")},function(e,a){})},e.message=function(a){for(var o=0;o<a.length;o++){var t=a[o].createTime.substr(0,4)+"/"+a[o].createTime.substr(5,2)+"/"+a[o].createTime.substr(8,2);e.day.push(new Date(t).getDay()),1==e.day[o]?e.week="周一":2==e.day[o]?e.week="周二":3==e.day[o]?e.week="周三":4==e.day[o]?e.week="周四":5==e.day[o]?e.week="周五":6==e.day[o]?e.week="周六":7==e.day[o]&&(e.week="周日"),e.state=a[o].orderStatus,e.trxAmount=fmoney(a[o].trxAmout,2),e.img=imgRrc+"h5images/icon_shoujirecharge"+variable+".png",e.transactionType="手机充值",$(".list").append("<li><span class='one'><img src='"+e.img+"'></span><p><label>－"+e.trxAmount+"</label><i>"+e.transactionType+e.trxAmount+"元</i></p><b>"+e.week+"<br>"+a[o].createTime.substr(0,10)+"</b><em style='color: #FC5050;''>"+e.state+"</em></li>")}},a.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function topUpSuccessCtrl(e,a,o,t){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data");var s=angular.fromJson(o.josnObj);e.goodsInf=s.goodsInf,e.mobile=s.mobile,e.amount=s.money,e.merchName=s.rcvCstName,e.createTime=s.createTime,e.orderNo=s.orderNo,e.orderStatus=s.orderStatus,"0"==e.orderStatus?e.status="交易成功":e.status="交易失败",e.moneys=fmoney(e.amount,2),e.time=e.createTime.substr(0,4)+"-"+e.createTime.substr(4,2)+"-"+e.createTime.substr(6,2)+" "+e.createTime.substr(8,2)+":"+e.createTime.substr(10,2)+":"+e.createTime.substr(12,2),$(".topUpSuccess p img").attr("src",imgRrc+"h5images/zhuanzhang"+variable+".png"),e.goHome=function(){a.go("home")}}function setPayPswdCtrl(e,a,o,t,s){e.customerNo=getURLParameter("customerNo"),e.loginname=getQueryString("loginname"),e.setPayPswdFun=function(){var a=$(".currentPayPassword .payPswd").val(),t=$(".currentPayPassword .confirPayPswd").val(),s=/^\d{6}$/,r=s.test(a),n=s.test(t);if(""==a||""==t)e.msg="密码不可为空",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else if(a==t)if(1==r||1==n){var i="payPwd="+encryptByDES(t)+"&cstNo="+e.customerNo,c=md5(i+"&"+md5("12345678").toUpperCase()).toUpperCase(),l={};l.cstNo=e.customerNo,l.payPwd=encryptByDES(t),l.md5info=c,$.ajax({url:getRootPath()+"/BusinessEntraceAction.setPayPwd.do?FAPView=JSON",data:l,success:function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success){localStorage.setItem("payPwdData",t),e.msg="支付密码设置成功",e.openModalThree(),setTimeout(function(){e.closeModalThree()},2e3);var s={customerNo:e.customerNo,loginname:e.loginname},r=angular.toJson(s);o.go("home",{josnObj:r})}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():1==a.FAPStatus&&(e.msg=e.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})}else e.msg="请输入6位数字支付密码",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else e.msg="两次输入的支付密码不一致",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)},window.onload=function(){var e=document.getElementById("pass1");window.getComputedStyle(e).webkitTextSecurity||e.setAttribute("type","password");var a=document.getElementById("pass2");window.getComputedStyle(a).webkitTextSecurity||a.setAttribute("type","password")}(),s.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function changePayPassCtrl(e,a,o,t){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data");var s=angular.fromJson(t.jsonObj);e.certType=s.certType,e.customerNameCN=s.customerNameCN,e.mobileNo=s.mobileNo,e.certNo=s.certNo;var r={certType:e.certType,customerNameCN:e.customerNameCN,mobileNo:e.mobileNo,certNo:e.certNo},n=angular.toJson(r);e.rules_password=function(a){var o="",t=/^\d{6}$/.test(a);return""==a?(e.msg="密码不可为空",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3),o=!1):1==t?o=!0:(e.msg="必须输入6位有效数字",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3),o=!1),o},$("#enterPassword .psw01").off("focus").on("focus",function(){for(var e=document.getElementById("enterPassword").getElementsByTagName("input"),a=0;a<e.length;a++){var o=e[a];o.index=a,o.setAttribute("readonly",!0),o.onkeyup=function(){this.value=this.value.replace(/^(.).*$/,"$1");var a=this.index+1;a>e.length-1||(e[a].removeAttribute("readonly"),e[a].focus())}}e[0].removeAttribute("readonly")}),$("#enterPassword .psw06").keyup(function(){var a=$("#enterPassword .psw01").val()+$("#enterPassword .psw02").val()+$("#enterPassword .psw03").val()+$("#enterPassword .psw04").val()+$("#enterPassword .psw05").val()+$("#enterPassword .psw06").val();6==a.length?1==e.rules_password(a)&&($(".currentPayPassword").css("display","none"),$(".newPayPassword").css("display","block"),$("#newPasswords .psw01").off("focus").on("focus",function(){for(var e=document.getElementById("newPasswords").getElementsByTagName("input"),a=0;a<e.length;a++){var o=e[a];o.index=a,o.setAttribute("readonly",!0),o.onkeyup=function(){this.value=this.value.replace(/^(.).*$/,"$1");var a=this.index+1;a>e.length-1||(e[a].removeAttribute("readonly"),e[a].focus())}}e[0].removeAttribute("readonly")})):(e.msg="必须输入6位有效数字",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))}),$("#newPasswords .psw06").keyup(function(){var a=$("#newPasswords .psw01").val()+$("#newPasswords .psw02").val()+$("#newPasswords .psw03").val()+$("#newPasswords .psw04").val()+$("#newPasswords .psw05").val()+$("#newPasswords .psw06").val(),o=a.length;$("#newPasswords .psw06").val().length;6==o?1==e.rules_password(a)&&($(".newPayPassword").css("display","none"),$(".surePayPassword").css("display","block"),$("#surePassword .psw01").off("focus").on("focus",function(){for(var e=document.getElementById("surePassword").getElementsByTagName("input"),a=0;a<e.length;a++){var o=e[a];o.index=a,o.setAttribute("readonly",!0),o.onkeyup=function(){this.value=this.value.replace(/^(.).*$/,"$1");var a=this.index+1;a>e.length-1||(e[a].removeAttribute("readonly"),e[a].focus())}}e[0].removeAttribute("readonly")})):(e.msg="必须输入6位有效数字",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))}),$("#surePassword .psw06").keyup(function(){var o=$("#surePassword .psw01").val()+$("#surePassword .psw02").val()+$("#surePassword .psw03").val()+$("#surePassword .psw04").val()+$("#surePassword .psw05").val()+$("#surePassword .psw06").val();if(6==o.length){if(1==e.rules_password(o)){var t=$("#enterPassword .psw01").val()+$("#enterPassword .psw02").val()+$("#enterPassword .psw03").val()+$("#enterPassword .psw04").val()+$("#enterPassword .psw05").val()+$("#enterPassword .psw06").val(),s=$("#newPasswords .psw01").val()+$("#newPasswords .psw02").val()+$("#newPasswords .psw03").val()+$("#newPasswords .psw04").val()+$("#newPasswords .psw05").val()+$("#newPasswords .psw06").val(),r={};r.customerNo=e.customerNo,r.sessionId=e.sessionId,r.oldPassword=encryptByDES(t),r.newPassword=encryptByDES(s),r.confirmPassword=encryptByDES(o),$.ajax({url:getRootPath()+"/SecurityCenterAction.modifyPayPwd.do?FAPView=JSON",data:r,success:function(o){o=$.parseJSON(o);e.FAPErrorMessage=o.FAPErrorMessage,0==o.FAPStatus?1==o.success?(e.msg="支付密码修改成功",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3),a.go("settings",{jsonObj:n})):(e.msg=o.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):2==o.FAPStatus?loginH5Host():1==o.FAPStatus&&(e.msg=e.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})}}else e.msg="必须输入6位有效数字",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)}),o.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function comProblemsCtrl(e,a,o,t,s){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data"),$("#comProblems-view .comProblemsIcon img").attr("src",imgRrc+"h5images/wentixiangqing"+variable+".png"),$("#comProblems-view .jinru_back").css("background-image","url("+imgRrc+"h5images/icon_jinru_black"+variable+".png)"),$("#comProblems-view .depositBox img").attr("src",imgRrc+"h5images/wentixiangqing"+variable+".png")}function findPayPassCtrl(e,a,o,t){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data"),$("#findPayPass-view .resetPayPass .lock").css("background-image","url("+imgRrc+"h5images/icon_mima_black"+variable+".png)");var s=angular.fromJ;son(t.jsonObj),e.mobileNo=s.mobileNo,e.certType=s.certType,e.customerNameCN=s.customerNameCN,e.certNo=s.certNo;var r={certType:e.certType,customerNameCN:e.customerNameCN,mobileNo:e.mobileNo,certNo:e.certNo},n=angular.toJson(r);e.rules_password=function(a){var o="",t=/^\d{6}$/.test(a);return""==a?(e.msg="密码不可为空",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3),o=!1):1==t?o=!0:(e.msg="必须输入6位有效数字",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3),o=!1),o},e.sendPhoneCode=function(){var a={};a.mobileNo=encryptByDES(e.mobileNo),$.ajax({url:getRootPath()+"/PublicAction.sendSmsCode.do?FAPView=JSON",data:a,success:function(a){0==(a=$.parseJSON(a)).FAPStatus?1==a.success?sendMessage():(e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):2==a.FAPStatus?loginH5Host():(e.msg=e.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})},e.resetpay_submit=function(){curCount=0;""!==$(".getCode .msgCode").val()?($("#findPayPass-view .findPayPswd").css("display","none"),$("#findPayPass-view .findPayPswdSub").css("display","block")):(e.msg="短信验证码不能为空",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},e.reset_paypassword=function(){var a=$("#newPassword").val(),t=$("#confiemNewPassword").val(),s=$(".getCode .msgCode").val();if(1==e.rules_password(a)&&1==e.rules_password(t))if(a==t){var r={};r.customerNo=e.customerNo,r.sessionId=e.sessionId,r.userName=encryptByDES(e.mobileNo),r.findWay=0,r.password=encryptByDES(a),r.confirmPassword=encryptByDES(t),r.smsCode=encryptByDES(s),$.ajax({url:getRootPath()+"/SecurityCenterAction.findPayPwd.do?FAPView=JSON",data:r,success:function(a){a=$.parseJSON(a);e.FAPErrorMessage=a.FAPErrorMessage,0==a.FAPStatus?1==a.success&&(e.msg="新支付密码设置成功",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3),o.go("settings",{jsonObj:n})):2==a.FAPStatus?loginH5Host():1==a.FAPStatus&&(e.msg=e.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(){}})}else e.msg="两次输入的支付密码不一致",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)},a.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function passwordSetCtrl(e,a,o,t){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data");var s=angular.fromJson(t.jsonObj);e.mobileNo=s.mobileNo,e.certType=s.certType,e.customerNameCN=s.customerNameCN,e.certNo=s.certNo;var r={certType:e.certType,customerNameCN:e.customerNameCN,mobileNo:e.mobileNo,certNo:e.certNo},n=angular.toJson(r);$("#passwordSet-view .jinru_back").css("background-image","url("+imgRrc+"h5images/icon_jinru_black"+variable+".png)"),$("#passwordSet-view .changePayPass").off("click").on("click",function(){a.go("changePayPass",{jsonObj:n})}),$("#passwordSet-view .tofindPayPass").off("click").on("click",function(){a.go("findPayPass",{jsonObj:n})})}function personalInforCtrl(e,a,o){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data");var t=angular.fromJson(a.jsonObj);e.certType=t.certType,e.customerNameCN=t.customerNameCN,e.mobileNo=t.mobileNo;var s=t.certNo.substring(4,t.certNo.length-4);e.certNo=t.certNo.substr(0,4)+s.replace(s,"**********")+t.certNo.substr(t.certNo.length-4,4),0==e.certType?($(".personalName").text("未实名认证"),$(".personalCertNo").text("未实名认证")):1==e.certType&&($(".personalName").text(e.customerNameCN),$(".personalCertNo").text(e.certNo))}function realNameAuthCtrl(e,a,o,t,s){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data"),e.certNo=localStorage.getItem("certNoData"),e.customerNameCN=localStorage.getItem("customerNameData"),e.mobileNo=localStorage.getItem("mobileData"),$("#realNameAuth-view .realNameAuth .real_Name").css("background-image","url("+imgRrc+"h5images/icon_xingming_realname"+variable+".png)"),$("#realNameAuth-view .realNameAuth .id_Card").css("background-image","url("+imgRrc+"h5images/icon_idcard_realname"+variable+".png)"),e.next_sub=function(){var t=$(".authenticationName").val(),s=$(".IdNumber").val(),r={};r.customerNo=e.customerNo,r.sessionId=e.sessionId,r.realName=t,r.certNo=encryptByDES(s),r.certType="1",r.certExpire="",r.payPwd="",$.ajax({url:getRootPath()+"/SecurityCenterAction.certifyByUploadCert.do?FAPView=JSON",type:"post",data:r,success:function(t){t=$.parseJSON(t);if(e.FAPErrorMessage=t.FAPErrorMessage,0==t.FAPStatus)if(1==t.success){var s=t.data.authStatus;localStorage.setItem("trueNameStatusData",s),e.openModal(),e.realNameSuccessd=function(){a.clearCache();var t={certType:e.certNo,customerNameCN:e.customerNameCN,mobileNo:e.mobileNo,certNo:e.certNo},s=angular.toJson(t);o.go("settings",{jsonObj:s}),e.closeModal()}}else e.msg=t.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},4e3);else 2==t.FAPStatus?loginH5Host():(e.openModalTwo(),setTimeout(function(){e.closeModalTwo()},4e3))},error:function(){location="index.html"}})},t.fromTemplateUrl("templates/modalOne.html",{scope:e}).then(function(a){e.modalOne=a}),e.openModal=function(){e.modalOne.show()},e.closeModal=function(){e.modalOne.hide()},t.fromTemplateUrl("templates/modalTwo.html",{scope:e}).then(function(a){e.modalTwo=a}),e.openModalTwo=function(){e.modalTwo.show()},e.closeModalTwo=function(){e.modalTwo.hide()},t.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function settingsCtrl(e,a,o,t,s){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data"),e.certType=localStorage.getItem("trueNameStatusData"),$(".homeFooter p img").attr("src",imgRrc+"h5images/icon-rukou-logo"+variable+".png"),$("#settings-view .headPortrait img").attr("src",imgRrc+"h5images/icon_head_image"+variable+".png"),$("#settings-view .jinru_back").css("background-image","url("+imgRrc+"h5images/icon_jinru_black"+variable+".png)"),$("#settings-view .passwordSet img").attr("src",imgRrc+"h5images/icon_mimaguanli"+variable+".png"),$("#settings-view .customerSer img").attr("src",imgRrc+"h5images/icon_kefu"+variable+".png"),$("#settings-view .comProblems img").attr("src",imgRrc+"h5images/changjianwenti"+variable+".png"),$("#settings-view .headPortrait img").attr("src",imgRrc+"h5images/icon_head_image"+variable+".png"),$("#settings-view .mobileNumber .realName").css("background-image","url("+imgRrc+"h5images/Artboard"+variable+".png)"),$("#settings-view .jinru_back").css("background-image","url("+imgRrc+"h5images/icon_jinru_black"+variable+".png)"),$("#settings-view .passwordSet img").attr("src",imgRrc+"h5images/icon_mimaguanli"+variable+".png"),$("#settings-view .customerSer img").attr("src",imgRrc+"h5images/icon_kefu"+variable+".png");var r=angular.fromJson(t.jsonObj);e.mobileNo=r.mobileNo,e.customerNameCN=r.customerNameCN,e.certNo=r.certNo;var n={certType:e.certType,customerNameCN:e.customerNameCN,mobileNo:e.mobileNo,certNo:e.certNo},i=angular.toJson(n);0==e.certType?($(".mobileNumber .realName").css("background-image","url("+imgRrc+"h5images/Artboard"+variable+".png)"),$("#settings-view .authentication").off("click").on("click",function(){o.go("realNameAuth")})):1==e.certType&&($(".mobileNumber .realName").css("background-image","none").text(e.customerNameCN),$("#settings-view .authentication").off("click").on("click",function(){o.go("personalInfor",{jsonObj:i})})),$("#settings-view .passwordSetting").off("click").on("click",function(){o.go("passwordSet",{jsonObj:i})}),$("#settings-view .commonProblems").off("click").on("click",function(){o.go("comProblems")})}function sweepTheYardCtrl(e,a,o,t){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data"),e.customerNameCN=localStorage.getItem("customerNameData"),e.mobile=localStorage.getItem("mobileData"),e.certNo=localStorage.getItem("certNoData");var s=angular.fromJson(a.jsonPayObj);e.fullCardNo=s.fullCardNo,""==e.fullCardNo?$(".bottom p").html("使用全时钱包 付款 <span>更换</span>"):(e.fullCardNo=s.fullCardNo,$(".bottom p").html("使用全时通卡 ("+e.fullCardNo.substr(e.fullCardNo.length-4)+") 付款 <span>更换</span>")),$("#sweepTheYard-view dl").eq(0).find("dt img").attr("src",imgRrc+"h5images/icon_home_fukuancode"+variable+".png"),$("#sweepTheYard-view dl").eq(1).find("dt img").attr("src",imgRrc+"h5images/icon_home_saoyisao"+variable+".png"),e.dataType="7",e.money="0.01",e.payType="0";var r={};r.custerNo=e.customerNo,r.cardNo=e.fullCardNo,"0"==$(".bottom p").attr("data-type")?r.qrKey="17":r.qrKey="02",$.ajax({url:getRootPath()+"/ScanCodeAction.qrcode.do?FAPView=JSON",type:"post",data:r,success:function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success){var o=a.data.qrCode;e.order(o),$("#qr_container").qrcode({render:"canvas",correctLevel:0,text:o}),$("#imgcode").JsBarcode(o),e.qrCode=o.substr(0,4)+" "+o.substr(4,4)+" "+o.substr(8,4)+" "+o.substr(11,4)+" "+o.substr(14)}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}}),e.order=function(a){var o={};o.customerNo=e.customerNo,o.sessionId=e.sessionId,o.qrCode=a,$.ajax({url:getRootPath()+"/PublicPayAction.queryOrderDetail.do?FAPView=JSON",type:"post",data:o,success:function(a){0==(a=$.parseJSON(a)).FAPStatus?1==a.success||(e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})},e.sweepPayWay=function(){var a={dataType:e.dataType,money:e.money,payType:e.payType,fullCardNo:e.fullCardNo},t=angular.toJson(a);o.go("sweepPayWay",{josnObj:t})},t.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function transferCtrl(e,a,o){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data"),e.transfer=!0,e.transferNum=!1,$(".num img").attr("src",imgRrc+"h5images/icon_zhuanqszh_tel"+variable+".png"),$(".money img").attr("src",imgRrc+"h5images/icon_zhuannext_money"+variable+".png"),$(".text img").attr("src",imgRrc+"h5images/icon_zhuanzh_warm"+variable+".png"),$(".empty img").attr("src",imgRrc+"h5images/icon_wujilu@3x.png"),$(".phoneNum").keyup(function(){""==$(this).val()?$(".next").css("opacity","0.4"):$(".next").css("opacity","1")}),$(".transferMoney").keyup(function(){""==$(this).val()?$(".submit").css("opacity","0.4"):$(".submit").css("opacity","1")}),e.next=function(){if(""!=$(".phoneNum").val()){$(".next").css("opacity","0.4").attr("disabled","true");if(/^1[34578][0-9]{9}$/.test($(".phoneNum").val())){var a={};a.customerNo=e.customerNo,a.sessionId=e.sessionId,a.userName=$(".phoneNum").val(),a.userType="p",$.ajax({url:getRootPath()+"/CustomerAction.userCheck.do?FAPView=JSON",type:"post",data:a,success:function(a){a=$.parseJSON(a);$(".next").css("opacity","1").removeAttr("disabled"),0==a.FAPStatus?1==a.success?"0"==a.data.authstatus?(e.msg="对方账户未实名",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):(e.name=a.data.userName,e.phone=$(".phoneNum").val(),e.transfer=!1,e.transferNum=!0,e.$apply()):(e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})}else e.msg="手机号格式错误",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)}else e.msg="手机号不可为空",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)},e.transferPassword=function(){if(""!=$(".transferMoney").val()){if(/^\d+(\.\d+)?$/.test($(".transferMoney").val()))if($(".transferInstructions").val().length<=20){var o={recAcc:$(".phoneNum").val(),amount:$(".transferMoney").val(),remark:$(".transferInstructions").val(),name:$(".transferNum h2").text()},t=angular.toJson(o);a.go("transferPassword",{josnObj:t})}else e.msg="转账说明需20字以内",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else e.msg="金额格式错误",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)}else e.msg="金额不可为空",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)},o.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function transferPasswordCtrl(e,a,o,t){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data");var s=angular.fromJson(a.josnObj);e.recAcc=s.recAcc,e.amount=s.amount,e.remark=s.remark,e.name=s.name,e.money=fmoney(e.amount,2),$(".payPassword img").attr("src",imgRrc+"h5images/icon_zhuannext_money_w"+variable+".png"),payPassword(),$(".i-text").keyup(function(){for(var a=$(this).val(),t=a.length,s=0;s<=6;s++)$(".sixDigitPassword").find("i").eq(t).addClass("active").siblings("i").removeClass("active"),$(".sixDigitPassword").find("i").eq(t).prevAll("i").find("b").css({display:"block"}),$(".sixDigitPassword").find("i").eq(t-1).nextAll("i").find("b").css({display:"none"}),0==t?($(".sixDigitPassword").find("i").eq(0).addClass("active").siblings("i").removeClass("active"),$(".sixDigitPassword").find("b").css({display:"none"})):6==t&&($(".sixDigitPassword").find("b").css({display:"block"}),$(".sixDigitPassword").find("i").eq(5).addClass("active").siblings("i").removeClass("active"));if(6==t)if($(".mask").show().siblings(".mask_all").show().find(".mask_in").show(),1==/^\d{6}$/.test(a)){var r="amount="+e.amount+"&customerNo="+e.customerNo+"&mobileNo=&password="+encryptByDES(a)+"&recAcc="+encryptByDES(e.recAcc)+"&remark="+e.remark+"&smsCode=&smsFlg=0&touchID=&verifyCode=",n={};n.customerNo=e.customerNo,n.sessionId=e.sessionId,n.recAcc=encryptByDES(e.recAcc),n.amount=e.amount,n.password=encryptByDES(a),n.smsFlg=0,n.remark=e.remark,n.mobileNo="",n.smsCode="",n.touchID="",n.verifyCode="",n.signKey=publicKeyRSA(md5(r)),$.ajax({url:getRootPath()+"/TransactionAction.accTransfer.do?FAPView=JSON",type:"post",data:n,success:function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success){$(".mask_in").hide().siblings(".mask_success").show();var t={recAcc:e.recAcc,amount:e.amount,name:e.name,fapTime:a.FAPTime,orderId:a.data.orderId},s=angular.toJson(t);setTimeout(function(){$(".mask_success").hide(),o.go("transferSuccess",{josnObj:s})},2e3)}else $(".login_mask").show().text(a.errors.msg).siblings(".mask").hide().siblings(".mask_all").hide(),setTimeout(function(){$(".login_mask").hide()},2e3),$(".i-text").val(""),$(".sixDigitPassword").find("i").removeClass("active"),$(".sixDigitPassword").find("b").css({display:"none"});else 2==a.FAPStatus?loginH5Host():($(".login_mask").show().text(a.FAPErrorMessage).siblings(".mask").hide().siblings(".mask_all").hide(),setTimeout(function(){$(".login_mask").hide()},2e3),$(".i-text").val(""),$(".sixDigitPassword").find("i").removeClass("active"),$(".sixDigitPassword").find("b").css({display:"none"}))},error:function(e,a,o){}})}else $(".login_mask").show().text("支付密码格式错误，请重试").siblings(".mask").hide().siblings(".mask_all").hide(),setTimeout(function(){$(".login_mask").hide()},2e3)})}function transferRecordsCtrl(e,a,o){function t(e,a,o,t){$.ajax({url:e,type:"post",data:a,success:function(e){o(e)},error:function(e,a){t(e)}})}e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data"),$(".empty img").attr("src",imgRrc+"h5images/icon_wujilu@3x.png");var s=new Date;e.beginDate=getNowFormatDate(s.getFullYear()-1),e.endDate=getNowFormatDate(s.getFullYear());var r=getRootPath()+"/TransactionQueryAction.transferOrderQuery.do?FAPView=JSON";e.lists=[];var n=1;e.noMorePage=!1,e.day=[],e.$on("$ionicView.loaded",function(a,o){$(".list").html(""),e.noMorePage=!1,n=1,t(r,{customerNo:e.customerNo,sessionId:e.sessionId,beginDate:e.beginDate,endDate:e.endDate,beginPos:n,pageSize:10,orderBy:"3"},function(a){0==(a=$.parseJSON(a)).FAPStatus?1==a.success?0==a.data.transferOrderList.result.length?$(".empty").show().siblings().hide():(e.lists=a.data.transferOrderList.result,e.message(e.lists),$(".empty").hide().siblings().show()):(e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},function(e,a){})}),e.doRefresh=function(){$(".list").html(""),e.noMorePage=!1,n=1,t(r,{customerNo:e.customerNo,sessionId:e.sessionId,beginDate:e.beginDate,endDate:e.endDate,beginPos:n,pageSize:10,orderBy:"3"},function(a){0==(a=$.parseJSON(a)).FAPStatus?1==a.success?0==a.data.transferOrderList.result.length?$(".empty").show().siblings().hide():(e.lists=a.data.transferOrderList.result,e.message(e.lists),$(".empty").hide().siblings().show()):(e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)),e.$broadcast("scroll.refreshComplete")},function(e,a){})},e.loadMore=function(){$(".list").html(""),n+=10,t(r,{customerNo:e.customerNo,sessionId:e.sessionId,beginDate:e.beginDate,endDate:e.endDate,beginPos:n,pageSize:10,orderBy:"3"},function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success){var o=a.data.transferOrderList.result.length;o<10&&(e.noMorePage=!0,0==o&&$(".empty").show().siblings().hide());for(var t=0;t<o;t++)e.lists.push(a.data.transferOrderList.result[t]);e.message(e.lists),e.$apply()}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3));e.$broadcast("scroll.infiniteScrollComplete")},function(e,a){})},e.message=function(a){for(var o=0;o<a.length;o++){var t=a[o].createTime.substr(0,4)+"/"+a[o].createTime.substr(4,2)+"/"+a[o].createTime.substr(6,2);e.day.push(new Date(t).getDay()),1==e.day[o]?e.week="周一":2==e.day[o]?e.week="周二":3==e.day[o]?e.week="周三":4==e.day[o]?e.week="周四":5==e.day[o]?e.week="周五":6==e.day[o]?e.week="周六":7==e.day[o]&&(e.week="周日"),e.trxAmount=fmoney(a[o].amount,2),"1"==a[o].status?e.state="":"2"==a[o].status?e.state="交易失败":e.state="等待支付",a[o].payee?e.payee="-"+a[o].payee:e.payee="",e.img=imgRrc+"h5images/icon_zhuanzhang"+variable+".png",$(".list").append("<li><span class='one'><img src='"+e.img+"'></span><p><label>－"+e.trxAmount+"</label><i>"+a[o].orderDesc+e.trxAmount+"元"+e.payee+"</i></p><b>"+e.week+"<br>"+a[o].createTime.substr(4,2)+"-"+a[o].createTime.substr(6,2)+"</b><em style='color: #FC5050;''>"+e.state+"</em></li>")}},a.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function transferSuccessCtrl(e,a,o){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data");var t=angular.fromJson(a.josnObj);e.recAcc=t.recAcc,e.amount=t.amount,e.name=t.name,e.fapTime=t.fapTime,e.orderId=t.orderId,e.money=fmoney(e.amount,2),$(".transferSuccess p img").attr("src",imgRrc+"h5images/zhuanzhang"+variable+".png"),e.complete=function(){location.href="./index.html?customerNo="+e.customerNo+"&sessionId="+e.sessionId}}function transferTowalletCtrl(e,a){$("#transferTowallet-view .transferTowallet_One .transferTowallet .rechargeNum").css("background-image","url("+imgRrc+"h5images/icon_zhuanqszh_tel"+variable+".png)"),$("#transferTowallet-view .transferTowallet_Two .transferTowallet .rechargeMoney").css("background-image","url("+imgRrc+"h5images/icon_zhuannext_money"+variable+".png)"),$("#transferTowallet-view .transferTowallet_Two .transferTowallet .rechargeText").css("background-image","url("+imgRrc+"h5images/icon_zhuanzh_warm"+variable+".png)"),$("#transferTowallet-view .transferTowallet_Three .p2 span").css("background-image","url("+imgRrc+"h5images/icon_zhuannext_money_w"+variable+".png)"),$("#transferDetails-view .recePerson .p3 span").css("background-image","url("+imgRrc+"h5images/zhuanzhang"+variable+".png)"),$("#transferRecord-view .month_box .icomImg").css({"background-image":"url("+imgRrc+"h5images/icon_zhuanzhang"+variable+".png)",opacity:"50%"}),$("#transferRecord-view .month_box .icomImgFailure").css("background-image","url("+imgRrc+"h5images/icon_zhuanzhang"+variable+".png)"),$("#transferRecord-view .transferRecordNone img").attr("src",imgRrc+"h5images/icon_wujilu"+variable+".png")}function billingDetailsCtrl(e,a,o,t){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data"),e.certNo=localStorage.getItem("certNoData"),e.customerNameCN=localStorage.getItem("customerNameData"),e.mobileNo=localStorage.getItem("mobileData");var s=angular.fromJson(a.waterJsonObj);e.text=s.text,e.type=s.type,e.companyName=s.companyName,e.cid=s.cid,e.pid=s.pid,e.picoid=s.picoid,e.protype=s.protype,e.cityName=s.cityName,e.yearmonth=s.yearmonth,e.paymentNum=s.paymentNum,e.truename=s.truename,e.phsid=s.phsid,e.showMessage=!0;e.text,e.type,e.companyName,e.cid,e.pid,e.picoid,e.protype,e.cityName,e.bills,e.yearmonth,e.paymentNum,e.truename;var r=angular.toJson(s),n=/^\d+(\.\d+)?$/;$(".inputMoney").keyup(function(){n.test($(this).val())?$(".paymentConfirm").css("opacity","1"):$(".paymentConfirm").css("opacity","0.4")}),$(".paymentConfirm").off("click").on("click",function(){if("1"==$(this).css("opacity")){e.money=fmoney($(".inputMoney").val(),2);var a={money:e.money},t=angular.toJson(a);o.go("paymentConfirm",{waterJsonObj:r,lifeJsonObj:t})}else""==$(".inputMoney").val()?(e.msg="支付金额为空",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):(e.msg="支付金额格式错误",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))}),t.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a,e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}),t.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function cityChangesCtrl(e,a,o,t,s,r,n,i,c,l){var m=angular.fromJson(a.waterJsonObj);s.text=m.text,s.type=m.type,s.phsid=m.phsid,s.city=m.city,s.message=m.message,s.searchEmptyShow=!1,s.showMiddle=!1,s.hIndex=(window.screen.height-44-4)/26;var d="ABCDEFGHIJKLMNOPQRSTUVWXYZ";s.indexs=[],c.show(),e.get("json/city.json").success(function(e){s.cityDatas=e.dataList,c.hide()});for(var u=0;u<d.length;u++)s.indexs.push(d.charAt(u));s.startDot=function(){(s.cityName.length=""==s.cityName)?s.searchEmptyShow=!1:s.searchEmptyShow=!0},s.searchEmpty=function(){s.searchEmptyShow=!1,s.cityName=""},s.mTouch=function(e){var a=e.pageX||e.touches[0].pageX,o=e.pageY||e.touches[0].pageY,t=document.elementFromPoint(a,o);if(t){var r=t.innerText;if(r&&" "!=r&&1==r.length){s.hint=r,s.showMiddle=!0;var n=document.getElementById("city_"+s.hint).offsetTop-l.getScrollPosition().top;l.scrollBy(0,n,!0);(t=document.getElementsByTagName("ion-content"))[0].style.overflow="auto"}}},s.mRelease=function(){$timeout(function(){s.showMiddle=!1},300)},s.confirmCity=function(e,a){var o={phsid:s.phsid,text:s.text,type:s.type,city:a.substr(0,2),message:s.message},t=angular.toJson(o);r.go("jiaofeiRecord",{waterJsonObj:t})}}function institutionsListCtrl(e,a,o,t){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data"),e.certNo=localStorage.getItem("certNoData"),e.customerNameCN=localStorage.getItem("customerNameData"),e.mobileNo=localStorage.getItem("mobileData");var s=angular.fromJson(a.waterJsonObj);e.text=s.text,e.type=s.type,e.phsid=s.phsid,e.city=s.city,e.message=s.message,$("#institutionsList-view .noneImg").css("background-image","url("+imgRrc+"h5images/icon_wujilu"+variable+".png)"),e.electric=function(a){var t={};t.customerNo=e.customerNo,t.sessionId=e.sessionId,t.cityName=e.city,$.ajax({url:getRootPath()+a,type:"post",data:t,success:function(a){0==(a=$.parseJSON(a)).FAPStatus?1==a.success?("1"==e.type?0==a.data.WaterCompanyList?e.isHideImg=!0:(e.isHideImg=!1,e.companyList=a.data.WaterCompanyList,e.$apply()):"2"==e.type?0==a.data.electricityFeesCompanyList?e.isHideImg=!0:(e.isHideImg=!1,e.companyList=a.data.electricityFeesCompanyList,e.$apply()):0==a.data.coalGasCompanyList?e.isHideImg=!0:(e.isHideImg=!1,e.companyList=a.data.coalGasCompanyList,e.$apply()),e.waterElectricityFuelGas=function(a){angular.toJson(s);var t=a.target.innerHTML,r={phsid:e.phsid,text:e.text,type:e.type,message:t,city:e.city},n=angular.toJson(r);o.go("jiaofeiRecord",{waterJsonObj:n})}):(e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})},"1"==e.type?e.electric("/WaterCompanyAction.findWaterCompanyDataList.do?FAPView=JSON"):"2"==e.type?e.electric("/ElectricityFeesCompanyAction.findElectricityFeesCompanyDataList.do?FAPView=JSON"):e.electric("/CoalGasCompanyAction.findCoalgascompanyDataList.do?FAPView=JSON"),t.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function jiaofeiRecordCtrl(e,a,o,t,s){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data"),e.certNo=localStorage.getItem("certNoData"),e.customerNameCN=localStorage.getItem("customerNameData"),e.mobileNo=localStorage.getItem("mobileData");var r=angular.fromJson(o.waterJsonObj);e.text=r.text,e.type=r.type,e.phsid=r.phsid,e.message=r.message,e.city=r.city,e.ptdCardNo=r.ptdCardNo,e.maskContent=!1,$(".waterElectricityFuelGas li").eq(0).find("i img").attr("src",imgRrc+"h5images/icon_jinru_black"+variable+".png"),$(".waterElectricityFuelGas li").eq(1).find("i img").attr("src",imgRrc+"h5images/icon_life_hint"+variable+".png"),$(".waterElectricityFuelGas div img").attr("src",imgRrc+"h5images/icon_life_position"+variable+".png"),$(".add").attr("src",imgRrc+"h5images/add.png"),e.goPaymentRecords=function(){t.go("paymentRecords")},e.showMask=function(){e.maskContent=!0},e.close=function(){e.maskContent=!1},""==e.ptdCardNo?$(".paymentNum").val(""):$(".paymentNum").val(e.ptdCardNo),$(".goPayMoney").off("click").on("click",function(){""==$(".waterElectricityFuelGas label").text()?(e.msg="请选择缴费单位",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):""==$(".paymentNum").val()?(e.msg="请输入正确缴费账号",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):"1"==$(this).css("opacity")?(e.electric=function(a){var o={};o.customerNo=e.customerNo,o.sessionId=e.sessionId,o.cityName=e.city,$.ajax({url:getRootPath()+a,type:"post",data:o,success:function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success){"1"==e.type?(e.company=a.data.WaterCompanyList,e.$apply()):"2"==e.type?(e.company=a.data.electricityFeesCompanyList,e.$apply()):"3"==e.type&&(e.company=a.data.coalGasCompanyList,e.$apply()),e.cityId=e.company[0].cityId,e.cityName=e.company[0].cityName,e.companyName=e.company[0].companyName,e.companyNo=e.company[0].companyNo,e.productType=e.company[0].productType,e.provinceId=e.company[0].provinceId;var o={},s=new Date,r=s.getFullYear(),n=s.getMonth()+1;parseInt(n)<10&&(n="0"+n);var i=r+n;o.customerNo=e.customerNo,o.sessionId=localStorage.getItem("data"),o.account=$(".paymentNum").val(),o.yearmonth=i,o.pid=e.provinceId,o.cid=e.cityId,o.picoid=e.companyNo,o.protype=e.productType,o.truename="",o.cityName=e.cityName,$.ajax({url:getRootPath()+"/EsaiAction.eSaiPubQuery.do?FAPView=JSON",type:"post",data:o,success:function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success){if("f"==a.data.result)e.msg=a.data.errmsg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},4e3);else if(e.yearmonth=a.data.yearmonth.substr(0,4)+"-"+a.data.yearmonth.substr(4,2),e.paymentNum=a.data.account,e.truename=a.data.truename,e.message=e.companyName,"1"==e.type){var o={text:e.text,type:e.type,phsid:e.phsid,companyName:e.companyName,cid:e.cityId,pid:e.provinceId,picoid:e.companyNo,protype:e.productType,cityName:e.cityName,yearmonth:e.yearmonth,paymentNum:e.paymentNum,truename:e.truename},s=angular.toJson(o);t.go("billingDetailsShui",{waterJsonObj:s})}else if("2"==e.type){var o={text:e.text,type:e.type,phsid:e.phsid,companyName:e.companyName,cid:e.cityId,pid:e.provinceId,picoid:e.companyNo,protype:e.productType,cityName:e.cityName,yearmonth:e.yearmonth,paymentNum:e.paymentNum,truename:e.truename},s=angular.toJson(o);t.go("billingDetailsDian",{waterJsonObj:s})}else if("3"==e.type){var o={text:e.text,type:e.type,phsid:e.phsid,companyName:e.companyName,cid:e.cityId,pid:e.provinceId,picoid:e.companyNo,protype:e.productType,cityName:e.cityName,yearmonth:e.yearmonth,paymentNum:e.paymentNum,truename:e.truename},s=angular.toJson(o);t.go("billingDetailsRan",{waterJsonObj:s})}}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.showMessage=!1,e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})},"1"==e.type?e.electric("/WaterCompanyAction.findWaterCompanyDataList.do?FAPView=JSON"):"2"==e.type?e.electric("/ElectricityFeesCompanyAction.findElectricityFeesCompanyDataList.do?FAPView=JSON"):e.electric("/CoalGasCompanyAction.findCoalgascompanyDataList.do?FAPView=JSON")):(e.msg="缴费号码格式错误！",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))}),e.institutionsList=function(){var a={phsid:e.phsid,text:e.text,type:e.type,city:e.city,message:e.message},o=angular.toJson(a);t.go("institutionsList",{waterJsonObj:o})},$(".paymentNum").keyup(function(){10==$(this).val().length?$(".billingDetails").css("opacity","1"):$(".billingDetails").css("opacity","0.4")}),e.cityChangesFun=function(){var a={phsid:e.phsid,text:e.text,type:e.type,city:e.city},o=angular.toJson(a);t.go("cityChanges",{waterJsonObj:o})},s.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a,e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}),s.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function paymentConfirmCtrl(e,a,o,t){$(".paymentConfirm h2 img").attr("src",imgRrc+"h5images/icon_zhuannext_money_w"+variable+".png"),e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data"),e.certNo=localStorage.getItem("certNoData"),e.customerNameCN=localStorage.getItem("customerNameData"),e.mobileNo=localStorage.getItem("mobileData");var s=angular.fromJson(a.waterJsonObj);e.text=s.text,e.type=s.type,e.companyName=s.companyName,e.cid=s.cid,e.pid=s.pid,e.picoid=s.picoid,e.protype=s.protype,e.cityName=s.cityName,e.yearmonth=s.yearmonth,e.paymentNum=s.paymentNum,e.truename=s.truename;var r=angular.fromJson(a.lifeJsonObj);e.money=r.money,e.paymentWay=function(){var a={yearmonth:e.yearmonth,money:e.money,dataType:"4",payType:"4",areaName:e.cityName,receiverName:e.companyName,userNo:e.paymentNum,itemName:e.text,phsid:e.type,picoid:e.picoid,pid:e.pid,cid:e.cid,truename:e.truename,protype:e.protype,phsid:s.phsid},t=angular.toJson(a),r={money:e.money},n=angular.toJson(r);o.go("paymentWay",{josnObj:t,lifeJsonObj:n})}}function paymentMessageCtrl(e,a,o,t){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data"),e.customerNameCN=localStorage.getItem("customerNameData"),e.mobile=localStorage.getItem("mobileData"),e.certNo=localStorage.getItem("certNoData");var s=angular.fromJson(a.josnObj);e.areaName=s.areaName,e.cid=s.cid,e.dataType=s.dataType,e.itemName=s.itemName,e.money=s.money,e.payType=s.payType,e.picoid=s.picoid,e.pid=s.pid,e.protype=s.protype,e.receiverName=s.receiverName,e.truename=s.truename,e.userNo=s.userNo,e.phsid=s.phsid,e.yearmonth=s.yearmonth;var r=angular.fromJson(a.jsonPayObj);e.bankCardType=r.bankCardType,e.cardNo=r.cardNo,e.certNo=r.certNo;var n=new Date,i=n.getFullYear(),c=n.getMonth()+1;parseInt(c)<10&&(c="0"+c);e.obtainCode=function(){var a=new Date,o=a.getFullYear(),t=a.getMonth()+1;parseInt(t)<10&&(t="0"+t);var s=o+t;$(".submitBut").css("opacity","1"),$(".messageCode").attr("disabled","true").css({background:"#ccc",border:"none",color:"#fff"});var r={},n="amount="+e.money+"&areaName="+e.areaName+"&cardNo="+encryptByDES(e.cardNo)+"&cid="+e.cid+"&customerNo="+e.customerNo+"&inOrderorgi=01&itemName="+e.itemName+"&payChannel=002&payPassword="+encryptByDES("")+"&payType=26&phsid="+e.phsid+"&picoid="+e.picoid+"&pid="+e.pid+"&protype="+e.protype+"&receiverName="+e.receiverName+"&truename="+e.truename+"&userNo="+encryptByDES(e.userNo)+"&yearmonth="+s;r.customerNo=e.customerNo,r.sessionId=e.sessionId,r.areaName=e.areaName,r.receiverName=e.receiverName,r.userNo=encryptByDES(e.userNo),r.amount=e.money,r.payType="26",r.payChannel="002",r.itemName=e.itemName,r.inOrderorgi="01",r.picoid=e.picoid,r.pid=e.pid,r.cid=e.cid,r.truename=e.truename,r.yearmonth=s,r.cardNo=encryptByDES(e.cardNo),r.protype=e.protype,r.phsid=e.phsid,r.payPassword=encryptByDES(""),r.signKey=publicKeyRSA(md5(n)),$.ajax({url:getRootPath()+"/ChargingPaymentAction.publicPaymentCreateBill.do?FAPView=JSON",data:r,success:function(a){$(".messageCode").removeAttr("disabled").css({background:"none",border:"1px solid #333",color:"#333"});if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success){var o=a.data.payPaymentStatus;if("1"==o)e.msg=a.data.errMsg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else if("0"==o){sendMessage();var t=a.data.tranflow;localStorage.setItem("tranflowData",t)}}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){$(".messageCode").removeAttr("disabled").css({background:"none",border:"1px solid #333",color:"#333"})}})},e.paySubmit=function(a){var t=new Date,s=t.getFullYear(),r=t.getMonth()+1;parseInt(r)<10&&(r="0"+r);var n=s+r;$(".submitBut").attr("disabled","true").css("opacity","0.4");var i=$(".obtainCode input").val();if(e.tranflow=localStorage.getItem("tranflowData"),""==i)e.msg="验证码不可为空",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else{var c={};c.customerNo=e.customerNo,c.sessionId=e.sessionId,c.areaName=e.areaName,c.receiverName=e.receiverName,c.userNo=encryptByDES(e.userNo),c.amount=e.money,c.payType="26",c.payChannel="002",c.itemName=e.itemName,c.inOrderorgi="01",c.picoid=e.picoid,c.pid=e.pid,c.cid=e.cid,c.truename=e.truename,c.yearmonth=n,c.cardNo=encryptByDES(e.cardNo),c.protype=e.protype,c.mobileCode=encryptByDES(i),c.tranFlowNo=e.tranflow;var l="amount="+e.money+"&areaName="+e.areaName+"&cardNo="+encryptByDES(e.cardNo)+"&cid="+e.cid+"&customerNo="+e.customerNo+"&inOrderorgi=01&itemName="+e.itemName+"&mobileCode="+encryptByDES(i)+"&payChannel=002&payType=26&picoid="+e.picoid+"&pid="+e.pid+"&protype="+e.protype+"&receiverName="+e.receiverName+"&tranFlowNo="+e.tranflow+"&truename="+e.truename+"&userNo="+encryptByDES(e.userNo)+"&yearmonth="+n;c.signKey=publicKeyRSA(md5(l)),$.ajax({url:getRootPath()+"/ChargingPaymentAction.publicPaymentCreateBillConfirm.do?FAPView=JSON",data:c,success:function(a){$(".submitBut").removeAttr("disabled").css("opacity","1");if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success)if(1==a.data.payPaymentStatus);else{e.errMsg=a.data.errMsg,e.tranflow=a.data.tranflow,e.transactionOrderDetail=a.data.transactionOrderDetail,e.truename=a.data.truename,e.userNo=a.data.userNo;var t={errMsg:e.errMsg,tranflow:e.tranflow,transactionOrderDetail:e.transactionOrderDetail,truename:e.truename,userNo:e.userNo,receiverName:e.receiverName},s=angular.toJson(t);o.go("paymentSuccess",{jsonObj:s})}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){$(".submitBut").removeAttr("disabled").css("opacity","1")}})}},t.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function paymentPasswordCtrl(e,a,o,t){e.customerNo=getURLParameter("customerNo"),e.sessionId=getURLParameter("sessionId");var s=angular.fromJson(a.josnObj);e.customerNameCN=s.customerNameCN,e.mobileNo=s.mobileNo,e.certNo=s.certNo;var r=angular.fromJson(a.jsonPayObj);e.userNo=r.userNo,e.money=r.money,e.moneys=fmoney(e.money,2);var n=new Date,i=n.getFullYear(),c=n.getMonth()+1;parseInt(c)<10&&(c="0"+c);var l=i+c;$(".payPassword h3 img").attr("src",imgRrc+"h5images/icon_zhuannext_money_w"+variable+".png"),e.replace=function(){var a={certNo:e.certNo,customerNameCN:e.customerNameCN,mobileNo:e.mobile,money:e.money,dataType:"4",payType:"4",areaName:r.areaName,receiverName:r.receiverName,userNo:r.userNo,itemName:r.itemName,picoid:r.picoid,pid:r.pid,cid:r.cid,truename:r.truename,protype:r.protype,phsid:r.phsid},t=angular.toJson(a);o.go("paymentWay",{josnObj:t})},payPassword(),$(".i-text").keyup(function(){for(var a=$(this).val(),t=a.length,s=0;s<=6;s++)$(".sixDigitPassword").find("i").eq(t).addClass("active").siblings("i").removeClass("active"),$(".sixDigitPassword").find("i").eq(t).prevAll("i").find("b").css({display:"block"}),$(".sixDigitPassword").find("i").eq(t-1).nextAll("i").find("b").css({display:"none"}),0==t?($(".sixDigitPassword").find("i").eq(0).addClass("active").siblings("i").removeClass("active"),$(".sixDigitPassword").find("b").css({display:"none"})):6==t&&($(".sixDigitPassword").find("b").css({display:"block"}),$(".sixDigitPassword").find("i").eq(5).addClass("active").siblings("i").removeClass("active"));if(6==t)if($(".mask").show().siblings(".mask_all").show().find(".mask_in").show(),1==/^\d{6}$/.test(a)){var n={},i="amount="+r.money+"&areaName="+r.areaName+"&cardNo="+encryptByDES("")+"&cid="+r.cid+"&customerNo="+e.customerNo+"&inOrderorgi=02&itemName="+r.itemName+"&payChannel=005&payPassword="+encryptByDES($(".i-text").val())+"&payType=01&phsid="+r.phsid+"&picoid="+r.picoid+"&pid="+r.pid+"&protype="+r.protype+"&receiverName="+r.receiverName+"&truename="+r.truename+"&userNo="+encryptByDES(r.userNo)+"&yearmonth="+l;n.customerNo=e.customerNo,n.sessionId=e.sessionId,n.areaName=r.areaName,n.receiverName=r.receiverName,n.userNo=encryptByDES(r.userNo),n.amount=r.money,n.payType="01",n.payChannel="005",n.itemName=r.itemName,n.inOrderorgi="02",n.picoid=r.picoid,n.pid=r.pid,n.cid=r.cid,n.truename=r.truename,n.yearmonth=l,n.cardNo=encryptByDES(""),n.protype=r.protype,n.phsid=r.phsid,n.payPassword=encryptByDES($(".i-text").val()),n.signKey=publicKeyRSA(md5(i)),$.ajax({url:getRootPath()+"/ChargingPaymentAction.publicPaymentCreateBill.do?FAPView=JSON",type:"post",data:n,success:function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success)if(0==a.data.payPaymentStatus){$(".mask_in").hide().siblings(".mask_success").show();var t={orderStatus:a.data.transactionOrderDetail.orderStatus,sellPrice:e.sellPrice,goodsInf:a.data.transactionOrderDetail.goodsInf,mobile:e.mobile,amount:e.money,merchName:a.data.transactionOrderDetail.merchName,createTime:a.data.transactionOrderDetail.createTime,orderNo:a.data.transactionOrderDetail.orderNo};angular.toJson(t);setTimeout(function(){$(".mask").hide(),o.go("paymentSuccess")},2e3)}else $(".login_mask").show().text(a.data.errMsg).siblings(".mask").hide().siblings(".mask_all").hide(),setTimeout(function(){$(".login_mask").hide()},2e3),$(".i-text").val(""),$(".sixDigitPassword").find("i").removeClass("active"),$(".sixDigitPassword").find("b").css({display:"none"});else $(".login_mask").show().text(a.errors.msg).siblings(".mask").hide().siblings(".mask_all").hide(),setTimeout(function(){$(".login_mask").hide()},2e3),$(".i-text").val(""),$(".sixDigitPassword").find("i").removeClass("active"),$(".sixDigitPassword").find("b").css({display:"none"});else 2==a.FAPStatus?loginH5Host():($(".login_mask").show().text(a.FAPErrorMessage).siblings(".mask").hide().siblings(".mask_all").hide(),setTimeout(function(){$(".login_mask").hide()},2e3),$(".i-text").val(""),$(".sixDigitPassword").find("i").removeClass("active"),$(".sixDigitPassword").find("b").css({display:"none"}))},error:function(e,a,o){}})}else $(".login_mask").show().text("支付密码格式错误，请重试").siblings(".mask").hide().siblings(".mask_all").hide(),setTimeout(function(){$(".login_mask").hide()},2e3)})}function paymentRecordsCtrl(e,a,o,t,s,r,n){function i(e,a,o,t){$.ajax({url:e,type:"post",data:a,success:function(e){o(e)},error:function(e,a){t(e)}})}e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data"),$(".paymentRecords .water img").attr("src",imgRrc+"h5images/icon_life_water24"+variable+".png"),$(".paymentRecords .electric img").attr("src",imgRrc+"h5images/icon_life_electric24"+variable+".png"),$(".paymentRecords .gas img").attr("src",imgRrc+"h5images/icon_life_fire24"+variable+".png"),$(".empty img").attr("src",imgRrc+"h5images/icon_wujilu@3x.png");var c=new Date;e.beginDate=getNowFormatDate(c.getFullYear()-1),e.endDate=getNowFormatDate(c.getFullYear());var l=getRootPath()+"/ThridPayAccountAction.myOrderTradeQuery.do?FAPView=JSON";e.lists=[];var m=1;e.noMorePage=!1,e.day=[],e.$on("$ionicView.loaded",function(a,o){m=1,e.noMorePage=!1,$(".list").html(""),i(l,{customerNo:e.customerNo,sessionId:e.sessionId,beginDate:e.beginDate,endDate:e.endDate,limit:10,orderBy:4,page:m,selectMark:"JF"},function(a){0==(a=$.parseJSON(a)).FAPStatus?1==a.success?0==a.data.orderTradeList.length?($(".empty").show(),$(".emptyTwo").hide(),$(".empty img").attr("src",imgRrc+"h5images/icon_wujilu@3x.png")):(e.lists=a.data.orderTradeList,e.message(e.lists)):(e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},function(e,a){})}),e.doRefresh=function(){m=1,e.noMorePage=!1,$(".list").html(""),i(l,{customerNo:e.customerNo,sessionId:e.sessionId,beginDate:e.beginDate,endDate:e.endDate,limit:10,orderBy:4,page:m,selectMark:"JF"},function(a){0==(a=$.parseJSON(a)).FAPStatus?1==a.success?0==a.data.orderTradeList.length?($(".empty").show(),$(".emptyTwo").hide()):(e.lists=a.data.orderTradeList,e.message(e.lists)):(e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)),e.$broadcast("scroll.refreshComplete")},function(e,a){})},e.loadMore=function(){m+=10,$(".list").html(""),i(l,{customerNo:e.customerNo,sessionId:e.sessionId,beginDate:e.beginDate,endDate:e.endDate,limit:10,orderBy:4,page:m,selectMark:"JF"},function(a){if(0==(a=$.parseJSON(a)).FAPStatus)if(1==a.success){var o=a.data.orderTradeList.length;o<10&&(e.noMorePage=!0,0==o&&($(".empty").hide(),$(".emptyTwo").show()));for(var t=0;t<o;t++)e.lists.push(a.data.orderTradeList[t]);e.message(e.lists),e.$apply()}else e.msg=a.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3);else 2==a.FAPStatus?loginH5Host():(e.msg=a.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3));e.$broadcast("scroll.infiniteScrollComplete")},function(e,a){})},e.message=function(a){for(var o=0;o<a.length;o++){var t=a[o].createTime.substr(0,4)+"/"+a[o].createTime.substr(5,2)+"/"+a[o].createTime.substr(8,2);e.day.push(new Date(t).getDay());var s=new Date(t).getDay();1==s?e.week="周一":2==s?e.week="周二":3==s?e.week="周三":4==s?e.week="周四":5==s?e.week="周五":6==s?e.week="周六":0==s&&(e.week="周日"),e.trxAmount=fmoney(a[o].trxAmout,2),"成功"==a[o].orderStatus?e.state="交易成功":"失败"==a[o].orderStatus?e.state="交易失败":e.state="等待支付";var r=a[o].remark;"水费缴费"==r?(e.img=imgRrc+"h5images/icon_life_water24"+variable+".png",e.transactionType="水费缴费"):"电费缴费"==r?(e.img=imgRrc+"h5images/icon_life_electric24"+variable+".png",e.transactionType="电费缴费"):(e.img=imgRrc+"h5images/icon_life_fire24"+variable+".png",e.transactionType="燃气缴费"),$(".paymentRecords ul").append("<li><span class='one'><img src='"+e.img+"'></span><p><label>－"+e.trxAmount+"</label><i>"+e.transactionType+e.trxAmount+"元</i></p><b>"+e.week+"<br>"+a[o].createTime.substr(5,2)+"-"+a[o].createTime.substr(8,2)+"</b><em style='color: #FC5050;''>"+e.state+"</em></li>")}},r.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}function paymentSuccessCtrl(e,a,o,t){$(".paymentSuccess p img").attr("src",imgRrc+"h5images/zhuanzhang"+variable+".png");var s=angular.fromJson(o.jsonObj),r=s.transactionOrderDetail;e.trxAmount=r.trxAmount,e.receiverName=s.receiverName,e.goodsInf=r.goodsInf,e.userNo=s.userNo,e.rcvCstName=r.rcvCstName,e.createTime=r.createTime,e.orderNo=r.orderNo,e.createTimeNum=e.createTime.substr(0,4)+"-"+e.createTime.substr(4,2)+"-"+e.createTime.substr(6,2)+"  "+e.createTime.substr(8,2)+":"+e.createTime.substr(10,2),e.goTime=function(){t.go("home")}}function waterAgreementCtrl(e,a){}function waterElectricityFuelGasCtrl(e,a,o,t,s){e.customerNo=getURLParameter("customerNo"),e.sessionId=localStorage.getItem("data"),e.certNo=localStorage.getItem("certNoData"),e.customerNameCN=localStorage.getItem("customerNameData"),e.mobileNo=localStorage.getItem("mobileData");var r=angular.fromJson(o.waterJsonObj);e.text=r.text,e.type=r.type,e.phsid=r.phsid,e.message=r.message,e.city=r.city,e.list=r.list,e.ptdCardNo=r.ptdCardNo,e.maskContent=!1,e.electricityFuelGas=!1,e.paymentRecord=!1,$(".waterElectricityFuelGas li").eq(0).find("i img").attr("src",imgRrc+"h5images/icon_jinru_black"+variable+".png"),$(".waterElectricityFuelGas li").eq(1).find("i img").attr("src",imgRrc+"h5images/icon_life_hint"+variable+".png"),$(".waterElectricityFuelGas div img").attr("src",imgRrc+"h5images/icon_life_position"+variable+".png"),$(".add").attr("src",imgRrc+"h5images/add.png"),e.showMask=function(){e.maskContent=!0},e.close=function(){e.maskContent=!1},e.goPaymentRecords=function(){t.go("paymentRecords")},e.addPayment=function(){var a={text:e.text,type:e.type,phsid:e.type,message:"",city:"北京"},o=angular.toJson(a);t.go("jiaofeiRecord",{waterJsonObj:o})},"1"==e.type?$(".account").attr("src",imgRrc+"h5images/icon_life_water24"+variable+".png"):"2"==e.type?$(".account").attr("src",imgRrc+"h5images/icon_life_electric24"+variable+".png"):"3"==e.type&&$(".account").attr("src",imgRrc+"h5images/icon_life_fire24"+variable+".png"),e.onItemDeleteShui=function(a){e.ptdCustomerNo=a.ptdCustomerNo,e.ptdId=a.ptdId;var o={};o.ptdCustomerNo=e.ptdCustomerNo,o.ptdId=e.ptdId,$.ajax({url:getRootPath()+"/PayHydropowerAccDetailAction.deletePayHydropowerAccDetail.do?FAPView=JSON",type:"post",data:o,success:function(o){0==(o=$.parseJSON(o)).FAPStatus?1==o.success?(e.list.splice(e.list.indexOf(a),1),e.msg="缴费记录删除成功",e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):(e.msg=o.errors.msg,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3)):2==o.FAPStatus?loginH5Host():(e.msg=o.FAPErrorMessage,e.openModalThree(),setTimeout(function(){e.closeModalThree()},3e3))},error:function(e,a,o){}})},e.addPaymentAgain=function(a){e.receiverName=a.receiverName,e.ptdCardNo=a.ptdCardNo;var o={text:e.text,type:e.type,phsid:e.type,message:e.receiverName,city:e.city,ptdCardNo:e.ptdCardNo},s=angular.toJson(o);t.go("jiaofeiRecord",{waterJsonObj:s})},e.institutionsList=function(){var a={phsid:e.phsid,text:e.text,type:e.type,city:e.city},o=angular.toJson(a);t.go("institutionsList",{waterJsonObj:o})},$(".paymentNum").keyup(function(){10==$(this).val().length?$(".billingDetails").css("opacity","1"):$(".billingDetails").css("opacity","0.4")}),e.cityChangesFun=function(){var a={phsid:e.phsid,text:e.text,type:e.type,city:e.city},o=angular.toJson(a);t.go("cityChanges",{waterJsonObj:o})},s.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a,e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}),s.fromTemplateUrl("templates/modalThree.html",{scope:e}).then(function(a){e.modalThree=a}),e.openModalThree=function(){e.modalThree.show()},e.closeModalThree=function(){e.modalThree.hide()}}angular.module("myapp").controller("accountBalanceCtrl",["$scope","$state","$stateParams","$ionicModal",accountBalanceCtrl]),angular.module("myapp").controller("bankPhoneCodeCtrl",["$scope","$ionicHistory","$state","$stateParams","$ionicModal",bankPhoneCodeCtrl]),angular.module("myapp").controller("transactionDetailsCtrl",["$scope","$state","$stateParams","$ionicModal",transactionDetailsCtrl]),angular.module("myapp").controller("addBankCtrl",["$scope","$state","$stateParams","$ionicModal",addBankCtrl]),angular.module("myapp").controller("agreementCtrl",["$scope","$ionicModal",agreementCtrl]),angular.module("myapp").controller("bankListCtrl",["$scope","$stateParams","$state","$ionicModal",bankListCtrl]),angular.module("myapp").controller("supportCtrl",["$scope","$ionicModal",supportCtrl]),angular.module("myapp").controller("applyCardCtrl",["$scope","$stateParams","$state","$http","$ionicModal",applyCardCtrl]),angular.module("myapp").controller("applyCardListCtrl",["$scope","$stateParams","$ionicModal",applyCardListCtrl]),angular.module("myapp").controller("applyCardRecordsCtrl",["$scope","$ionicModal",applyCardRecordsCtrl]),angular.module("myapp").controller("applyOrderCtrl",["$scope","$stateParams","$state","$http","$ionicModal",applyOrderCtrl]),angular.module("myapp").controller("applyPayPasswordCtrl",["$scope","$stateParams","$state","$ionicModal",applyPayPasswordCtrl]),angular.module("myapp").controller("applySuccessCtrl",["$scope","$stateParams","$state","$ionicModal",applySuccessCtrl]),angular.module("myapp").controller("informationCtrl",["$scope","$http","$state","$stateParams","$ionicModal",informationCtrl]),angular.module("myapp").controller("instructionsCtrl",["$scope","$ionicModal",instructionsCtrl]),angular.module("myapp").controller("applyCreditCardCtrl",["$http","$scope","$state","$sce","$ionicModal",applyCreditCardCtrl]),angular.module("myapp").controller("billListCtrl",["$scope","$stateParams","$http","$state","$ionicHistory","$ionicModal","$ionicLoading",billListCtrl]),angular.module("myapp").controller("cardBalanceQueryCtrl",["$scope","$ionicModal",cardBalanceQueryCtrl]),angular.module("myapp").controller("couponsCtrl",["$scope","$ionicHistory","$ionicModal",couponsCtrl]),angular.module("myapp").controller("addFullCardCtrl",["$scope","$ionicHistory","$state","$stateParams","$ionicModal",addFullCardCtrl]),angular.module("myapp").controller("balanFullTimeCardCtrl",["$scope","$ionicHistory","$state","$stateParams","$ionicModal",balanFullTimeCardCtrl]),angular.module("myapp").controller("fullCardTraDetailsCtrl",["$scope","$state","$stateParams","$ionicModal",fullCardTraDetailsCtrl]),angular.module("myapp").controller("fullTimeCardCtrl",["$scope","$ionicHistory","$state","$stateParams","$ionicModal",fullTimeCardCtrl]),angular.module("myapp").controller("rechfullTimeCardCtrl",["$scope","$ionicHistory","$state","$stateParams","$ionicModal",rechfullTimeCardCtrl]),angular.module("myapp").controller("homeCtrl",["$scope","$ionicHistory","$state","$stateParams","$ionicModal","$ionicLoading",homeCtrl]),angular.module("myapp").controller("inviteCodeCtrl",["$scope","$stateParams","$state","$ionicModal",inviteCodeCtrl]),angular.module("myapp").controller("payMessageCtrl",["$scope","$stateParams","$state","$ionicModal",payMessageCtrl]),angular.module("myapp").controller("payMessageFlowCtrl",["$scope","$stateParams","$state","$ionicModal",payMessageFlowCtrl]),angular.module("myapp").controller("payPasswordCtrl",["$scope","$stateParams","$state","$ionicModal",payPasswordCtrl]),angular.module("myapp").controller("payPasswordFlowCtrl",["$scope","$stateParams","$state","$ionicModal",payPasswordFlowCtrl]),angular.module("myapp").controller("phoneRechargeCtrl",["$scope","$stateParams","$state","$ionicModal",phoneRechargeCtrl]),angular.module("myapp").controller("phoneRechargeRecordsCtrl",["$scope","$ionicModal",phoneRechargeRecordsCtrl]),angular.module("myapp").controller("topUpSuccessCtrl",["$scope","$state","$stateParams","$ionicModal",topUpSuccessCtrl]),angular.module("myapp").controller("setPayPswdCtrl",["$scope","$stateParams","$state","$http","$ionicModal",setPayPswdCtrl]),angular.module("myapp").controller("changePayPassCtrl",["$scope","$state","$ionicModal","$stateParams",changePayPassCtrl]),angular.module("myapp").controller("comProblemsCtrl",["$scope","$ionicHistory","$state","$stateParams","$ionicModal",comProblemsCtrl]),angular.module("myapp").controller("findPayPassCtrl",["$scope","$ionicModal","$state","$stateParams",findPayPassCtrl]),angular.module("myapp").controller("passwordSetCtrl",["$scope","$state","$ionicModal","$stateParams",passwordSetCtrl]),angular.module("myapp").controller("personalInforCtrl",["$scope","$stateParams","$ionicModal",personalInforCtrl]),angular.module("myapp").controller("realNameAuthCtrl",["$scope","$ionicHistory","$state","$ionicModal","$stateParams",realNameAuthCtrl]),angular.module("myapp").controller("settingsCtrl",["$scope","$ionicHistory","$state","$stateParams","$ionicModal",settingsCtrl]),angular.module("myapp").controller("sweepTheYardCtrl",["$scope","$stateParams","$state","$ionicModal",sweepTheYardCtrl]),angular.module("myapp").controller("transferCtrl",["$scope","$state","$ionicModal",transferCtrl]),angular.module("myapp").controller("transferPasswordCtrl",["$scope","$stateParams","$state","$ionicModal",transferPasswordCtrl]),angular.module("myapp").controller("transferRecordsCtrl",["$scope","$ionicModal","$ionicLoading",transferRecordsCtrl]),angular.module("myapp").controller("transferSuccessCtrl",["$scope","$stateParams","$ionicModal",transferSuccessCtrl]),angular.module("myapp").controller("transferTowalletCtrl",["$scope","$ionicModal",transferTowalletCtrl]),angular.module("myapp").controller("billingDetailsCtrl",["$scope","$stateParams","$state","$ionicModal",billingDetailsCtrl]),angular.module("myapp").controller("cityChangesCtrl",["$http","$stateParams","$location","$rootScope","$scope","$state","$filter","$ionicHistory","$ionicLoading","$ionicScrollDelegate",cityChangesCtrl]),angular.module("myapp").controller("institutionsListCtrl",["$scope","$stateParams","$state","$ionicModal",institutionsListCtrl]),angular.module("myapp").controller("jiaofeiRecordCtrl",["$scope","$ionicListDelegate","$stateParams","$state","$ionicModal",jiaofeiRecordCtrl]),angular.module("myapp").controller("paymentConfirmCtrl",["$scope","$stateParams","$state","$ionicModal",paymentConfirmCtrl]),angular.module("myapp").controller("paymentMessageCtrl",["$scope","$stateParams","$state","$ionicModal",paymentMessageCtrl]),angular.module("myapp").controller("paymentPasswordCtrl",["$scope","$stateParams","$state","$ionicModal",paymentPasswordCtrl]),angular.module("myapp").controller("paymentRecordsCtrl",["$scope","$stateParams","$http","$state","$ionicHistory","$ionicModal","$ionicLoading",paymentRecordsCtrl]),angular.module("myapp").controller("paymentSuccessCtrl",["$scope","$ionicModal","$stateParams","$state",paymentSuccessCtrl]),angular.module("myapp").controller("waterAgreementCtrl",["$scope","$ionicModal",waterAgreementCtrl]),angular.module("myapp").controller("waterElectricityFuelGasCtrl",["$scope","$ionicListDelegate","$stateParams","$state","$ionicModal",waterElectricityFuelGasCtrl]);